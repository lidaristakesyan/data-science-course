
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Complete Data Science Course Materials">
      
      
        <meta name="author" content="Lida Aristakesyan">
      
      
        <link rel="canonical" href="https://lidaristakesyan.github.io/data-science-course/lectures/Lecture01_Foundations/">
      
      
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Lecture 01: Data as a Building Block - Data Science Course</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lecture-01-data-as-a-building-block" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Data Science Course" class="md-header__button md-logo" aria-label="Data Science Course" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Data Science Course
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lecture 01: Data as a Building Block
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/lidaristakesyan/data-science-course" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    lidaristakesyan/data-science-course
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link">
        
  
  
    
  
  Lectures

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Data Science Course" class="md-nav__button md-logo" aria-label="Data Science Course" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Data Science Course
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/lidaristakesyan/data-science-course" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    lidaristakesyan/data-science-course
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lectures
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#part-i-foundations-of-data-engineering" class="md-nav__link">
    <span class="md-ellipsis">
      
        PART I: FOUNDATIONS OF DATA ENGINEERING
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PART I: FOUNDATIONS OF DATA ENGINEERING">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chapter-1-the-data-lifecycle-understanding-the-complete-journey" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter 1: The Data Lifecycle — Understanding the Complete Journey
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-introduction-why-data-engineering-matters" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 Introduction: Why Data Engineering Matters
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-the-data-lifecycle-a-conceptual-framework" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 The Data Lifecycle: A Conceptual Framework
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.2 The Data Lifecycle: A Conceptual Framework">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#121-the-eight-stages-of-the-data-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2.1 The Eight Stages of the Data Lifecycle
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122-stage-1-generation-where-data-originates" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2.2 Stage 1: Generation — Where Data Originates
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.2.2 Stage 1: Generation — Where Data Originates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sources-of-data-generation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sources of Data Generation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-importance-of-understanding-data-generation" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Importance of Understanding Data Generation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#123-stage-2-collection-bringing-data-into-your-systems" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2.3 Stage 2: Collection — Bringing Data Into Your Systems
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.2.3 Stage 2: Collection — Bringing Data Into Your Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#batch-vs-streaming-ingestion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Batch vs. Streaming Ingestion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-ingestion-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Common Ingestion Patterns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#124-stage-3-storage-persisting-data-for-future-use" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2.4 Stage 3: Storage — Persisting Data for Future Use
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.2.4 Stage 3: Storage — Persisting Data for Future Use">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-storage-landscape" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Storage Landscape
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#125-stage-4-transformation-making-data-useful" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2.5 Stage 4: Transformation — Making Data Useful
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.2.5 Stage 4: Transformation — Making Data Useful">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-transformation-spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Transformation Spectrum
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-etl-vs-elt-paradigm" class="md-nav__link">
    <span class="md-ellipsis">
      
        The ETL vs. ELT Paradigm
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#126-stage-5-analysis-extracting-insights" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2.6 Stage 5: Analysis — Extracting Insights
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#127-stage-6-serving-delivering-value" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2.7 Stage 6: Serving — Delivering Value
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#128-stage-7-maintenance-ensuring-reliability" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2.8 Stage 7: Maintenance — Ensuring Reliability
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#129-stage-8-archival-managing-the-end-of-life" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2.9 Stage 8: Archival — Managing the End of Life
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13-roles-in-the-data-ecosystem" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3 Roles in the Data Ecosystem
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.3 Roles in the Data Ecosystem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131-the-core-data-roles" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3.1 The Core Data Roles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132-the-evolving-boundaries" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3.2 The Evolving Boundaries
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#14-event-tracking-and-event-driven-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.4 Event Tracking and Event-Driven Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.4 Event Tracking and Event-Driven Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#141-what-is-an-event" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.4.1 What is an Event?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#142-the-event-driven-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.4.2 The Event-Driven Architecture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#143-designing-an-event-taxonomy" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.4.3 Designing an Event Taxonomy
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.4.3 Designing an Event Taxonomy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#event-naming-conventions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Event Naming Conventions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-categories" class="md-nav__link">
    <span class="md-ellipsis">
      
        Event Categories
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#144-event-properties-and-context" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.4.4 Event Properties and Context
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.4.4 Event Properties and Context">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#properties-vs-context" class="md-nav__link">
    <span class="md-ellipsis">
      
        Properties vs. Context
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#identity-resolution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Identity Resolution
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#145-from-events-to-features-the-data-science-connection" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.4.5 From Events to Features: The Data Science Connection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#15-summary-and-key-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.5 Summary and Key Concepts
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.5 Summary and Key Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-data-lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Data Lifecycle
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#roles-in-the-data-ecosystem" class="md-nav__link">
    <span class="md-ellipsis">
      
        Roles in the Data Ecosystem
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#events-as-foundational-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Events as Foundational Data
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#16-further-reading-and-resources" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.6 Further Reading and Resources
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.6 Further Reading and Resources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#books" class="md-nav__link">
    <span class="md-ellipsis">
      
        Books
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#papers" class="md-nav__link">
    <span class="md-ellipsis">
      
        Papers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#online-resources" class="md-nav__link">
    <span class="md-ellipsis">
      
        Online Resources
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#17-exercises" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.7 Exercises
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="lecture-01-data-as-a-building-block">Lecture 01: Data as a Building Block<a class="headerlink" href="#lecture-01-data-as-a-building-block" title="Permanent link">&para;</a></h1>
<h2 id="part-i-foundations-of-data-engineering">PART I: FOUNDATIONS OF DATA ENGINEERING<a class="headerlink" href="#part-i-foundations-of-data-engineering" title="Permanent link">&para;</a></h2>
<h3 id="chapter-1-the-data-lifecycle-understanding-the-complete-journey">Chapter 1: The Data Lifecycle — Understanding the Complete Journey<a class="headerlink" href="#chapter-1-the-data-lifecycle-understanding-the-complete-journey" title="Permanent link">&para;</a></h3>
<hr />
<blockquote>
<p><em>"Data is a precious thing and will last longer than the systems themselves."</em>
— Tim Berners-Lee, inventor of the World Wide Web</p>
</blockquote>
<hr />
<h2 id="11-introduction-why-data-engineering-matters">1.1 Introduction: Why Data Engineering Matters<a class="headerlink" href="#11-introduction-why-data-engineering-matters" title="Permanent link">&para;</a></h2>
<p>In the modern era of artificial intelligence and machine learning, there is a common misconception that the magic happens in the models. Data scientists spend years mastering sophisticated algorithms, neural network architectures, and statistical methods. Yet, when they enter the workforce, they discover an uncomfortable truth: <strong>approximately 80% of their time is spent not on modeling, but on finding, cleaning, and preparing data.</strong></p>
<p>This reality has given rise to a fundamental shift in how we think about building intelligent systems. As Andrew Ng, co-founder of Google Brain and former Chief Scientist at Baidu, has emphasized through his advocacy for "data-centric AI": the quality of your data often matters more than the sophistication of your model. A simple logistic regression trained on excellent, well-curated data will frequently outperform a complex deep learning model trained on messy, poorly understood data.</p>
<p>The emerging field of data-centric AI "emphasizes the systematic engineering of data to build AI systems, shifting our focus from model to data. It is important to note that 'data-centric' differs fundamentally from 'data-driven', as the latter only emphasizes the use of data to guide AI development, which typically still centers on models" (Zha et al., 2023).</p>
<p>This chapter introduces you to the complete data lifecycle—the journey that data takes from its point of origin to its ultimate use in analysis, machine learning, and decision-making. Understanding this lifecycle transforms you from a passive consumer of datasets into an informed practitioner who can:</p>
<ul>
<li>Trace the provenance of any dataset and understand its limitations</li>
<li>Identify where data quality issues originate</li>
<li>Design better features because you understand the source systems</li>
<li>Communicate effectively with data engineers and infrastructure teams</li>
<li>Build your own data pipelines when necessary</li>
</ul>
<hr />
<h2 id="12-the-data-lifecycle-a-conceptual-framework">1.2 The Data Lifecycle: A Conceptual Framework<a class="headerlink" href="#12-the-data-lifecycle-a-conceptual-framework" title="Permanent link">&para;</a></h2>
<p>Data does not simply appear in a clean CSV file ready for analysis. It flows through a series of stages, each with its own challenges, tools, and best practices. Understanding this flow—the data lifecycle—provides the mental framework necessary for working effectively with data at any scale.</p>
<h3 id="121-the-eight-stages-of-the-data-lifecycle">1.2.1 The Eight Stages of the Data Lifecycle<a class="headerlink" href="#121-the-eight-stages-of-the-data-lifecycle" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>┌─────────────────────────────────────────────────────────────────────────────────┐
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>│                                                                                  │
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>│                         THE DATA LIFECYCLE                                       │
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>│                                                                                  │
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>│     ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐               │
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>│     │ GENERATE │───▶│ COLLECT  │───▶│  STORE   │───▶│TRANSFORM │               │
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>│     │          │    │ (Ingest) │    │ (Persist)│    │ (Process)│               │
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>│     └──────────┘    └──────────┘    └──────────┘    └──────────┘               │
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>│                                                            │                    │
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>│                                                            ▼                    │
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>│     ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐               │
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>│     │ ARCHIVE  │◀───│ MAINTAIN │◀───│  SERVE   │◀───│ ANALYZE  │               │
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>│     │ (Retire) │    │ (Operate)│    │ (Deliver)│    │ (Consume)│               │
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>│     └──────────┘    └──────────┘    └──────────┘    └──────────┘               │
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>│                                                                                  │
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>└─────────────────────────────────────────────────────────────────────────────────┘
</code></pre></div>
<p>Let us examine each stage in detail.</p>
<hr />
<h3 id="122-stage-1-generation-where-data-originates">1.2.2 Stage 1: Generation — Where Data Originates<a class="headerlink" href="#122-stage-1-generation-where-data-originates" title="Permanent link">&para;</a></h3>
<p>Every piece of data begins somewhere. Understanding the origin of data—its <strong>provenance</strong>—is essential for assessing its reliability, understanding its structure, and anticipating its limitations.</p>
<h4 id="sources-of-data-generation">Sources of Data Generation<a class="headerlink" href="#sources-of-data-generation" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Source Category</th>
<th>Examples</th>
<th>Characteristics</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Transactional Systems</strong></td>
<td>Point-of-sale systems, banking transactions, e-commerce orders</td>
<td>Highly structured, real-time, mission-critical accuracy</td>
</tr>
<tr>
<td><strong>User Interactions</strong></td>
<td>Website clicks, mobile app events, search queries</td>
<td>Semi-structured, extremely high volume, behavioral</td>
</tr>
<tr>
<td><strong>Operational Systems</strong></td>
<td>CRM records, ERP data, inventory management</td>
<td>Structured, business-process driven</td>
</tr>
<tr>
<td><strong>IoT and Sensors</strong></td>
<td>Temperature readings, GPS coordinates, machine telemetry</td>
<td>Time-series, continuous streams, potentially noisy</td>
</tr>
<tr>
<td><strong>Third-Party Sources</strong></td>
<td>APIs (weather, financial markets, social media), purchased datasets</td>
<td>Various formats, rate-limited, external dependencies</td>
</tr>
<tr>
<td><strong>User-Generated Content</strong></td>
<td>Reviews, comments, uploaded files, form submissions</td>
<td>Unstructured or semi-structured, requires validation</td>
</tr>
<tr>
<td><strong>Machine-Generated Logs</strong></td>
<td>Application logs, server metrics, error reports</td>
<td>Semi-structured, high volume, essential for debugging</td>
</tr>
</tbody>
</table>
<h4 id="the-importance-of-understanding-data-generation">The Importance of Understanding Data Generation<a class="headerlink" href="#the-importance-of-understanding-data-generation" title="Permanent link">&para;</a></h4>
<p>When you receive a dataset, asking "where did this data come from?" is not merely an academic exercise. The generation context determines:</p>
<ul>
<li><strong>Data quality</strong>: Manual entry systems have different error profiles than automated sensors</li>
<li><strong>Timeliness</strong>: Real-time systems provide current data; batch extracts may be hours or days old</li>
<li><strong>Completeness</strong>: Some systems capture everything; others sample or aggregate</li>
<li><strong>Bias</strong>: The mechanism of data collection often introduces systematic biases</li>
</ul>
<blockquote>
<p><strong>Key Insight</strong>: The most sophisticated analysis cannot overcome fundamental flaws introduced at the data generation stage. Always trace your data back to its source.</p>
</blockquote>
<hr />
<h3 id="123-stage-2-collection-bringing-data-into-your-systems">1.2.3 Stage 2: Collection — Bringing Data Into Your Systems<a class="headerlink" href="#123-stage-2-collection-bringing-data-into-your-systems" title="Permanent link">&para;</a></h3>
<p>Once data is generated, it must be captured and brought into your data infrastructure. This process—<strong>data ingestion</strong>—presents its own set of challenges and design decisions.</p>
<h4 id="batch-vs-streaming-ingestion">Batch vs. Streaming Ingestion<a class="headerlink" href="#batch-vs-streaming-ingestion" title="Permanent link">&para;</a></h4>
<p>The two fundamental paradigms for data collection are batch processing and stream processing:</p>
<p><strong>Batch Ingestion</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>┌─────────────┐     ┌─────────────────────┐     ┌─────────────┐
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>│   Source    │────▶│   Scheduled Job     │────▶│   Storage   │
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>│   System    │     │ (hourly/daily/weekly)│    │   System    │
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>└─────────────┘     └─────────────────────┘     └─────────────┘
</code></pre></div></p>
<p>Batch ingestion collects data at scheduled intervals. A nightly job might extract all new records from a production database, transform them, and load them into a data warehouse. This approach is:</p>
<ul>
<li>Simpler to implement and debug</li>
<li>More efficient for large volumes (economies of scale)</li>
<li>Acceptable when real-time data is not required</li>
<li>Easier to ensure data consistency</li>
</ul>
<p><strong>Stream Ingestion</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>┌─────────────┐     ┌─────────────────────┐     ┌─────────────┐
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>│   Source    │────▶│   Continuous        │────▶│   Storage   │
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>│   System    │     │   Stream Processor  │     │   System    │
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>└─────────────┘     └─────────────────────┘     └─────────────┘
</code></pre></div></p>
<p>Stream ingestion processes data continuously as it arrives. User click events might flow through Apache Kafka into a real-time analytics system within milliseconds. This approach is:</p>
<ul>
<li>Essential when freshness matters (fraud detection, real-time recommendations)</li>
<li>More complex to implement correctly</li>
<li>Requires careful handling of late-arriving data</li>
<li>Demands robust error handling for continuous operation</li>
</ul>
<h4 id="common-ingestion-patterns">Common Ingestion Patterns<a class="headerlink" href="#common-ingestion-patterns" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Pattern</th>
<th>Description</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Full Load</strong></td>
<td>Extract entire dataset each time</td>
<td>Small reference tables, initial loads</td>
</tr>
<tr>
<td><strong>Incremental Load</strong></td>
<td>Extract only new or changed records</td>
<td>Large transactional tables</td>
</tr>
<tr>
<td><strong>Change Data Capture (CDC)</strong></td>
<td>Capture individual insert/update/delete operations</td>
<td>Real-time replication, audit trails</td>
</tr>
<tr>
<td><strong>Event Streaming</strong></td>
<td>Continuous flow of discrete events</td>
<td>User behavior tracking, IoT data</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="124-stage-3-storage-persisting-data-for-future-use">1.2.4 Stage 3: Storage — Persisting Data for Future Use<a class="headerlink" href="#124-stage-3-storage-persisting-data-for-future-use" title="Permanent link">&para;</a></h3>
<p>Once collected, data must be stored in systems appropriate for its structure, volume, and intended use. The choice of storage system has profound implications for cost, query performance, and analytical capabilities.</p>
<h4 id="the-storage-landscape">The Storage Landscape<a class="headerlink" href="#the-storage-landscape" title="Permanent link">&para;</a></h4>
<p>Modern data infrastructure typically includes multiple storage systems, each optimized for different purposes:</p>
<p><strong>Databases</strong> are optimized for transactional operations—reading and writing individual records quickly and reliably. They store the current state of operational data.</p>
<p><strong>Data Warehouses</strong> are optimized for analytical queries—aggregating millions of records to answer business questions. They store historical data in structured, pre-defined schemas.</p>
<p><strong>Data Lakes</strong> store raw data in its native format, without requiring a pre-defined schema. They accommodate structured, semi-structured, and unstructured data at massive scale.</p>
<p>As the MongoDB documentation explains: "A database stores the current data required to power an application. A data warehouse stores current and historical data for one or more systems in a predefined and fixed schema for the purpose of analyzing the data. Data lakes store data in their raw form" (MongoDB, 2024).</p>
<p>We will explore these storage systems in depth in Chapter 3.</p>
<hr />
<h3 id="125-stage-4-transformation-making-data-useful">1.2.5 Stage 4: Transformation — Making Data Useful<a class="headerlink" href="#125-stage-4-transformation-making-data-useful" title="Permanent link">&para;</a></h3>
<p>Raw data is rarely suitable for analysis. The transformation stage encompasses all the processing required to convert raw data into analysis-ready datasets.</p>
<h4 id="the-transformation-spectrum">The Transformation Spectrum<a class="headerlink" href="#the-transformation-spectrum" title="Permanent link">&para;</a></h4>
<p>Transformations range from simple to complex:</p>
<table>
<thead>
<tr>
<th>Transformation Type</th>
<th>Examples</th>
<th>Complexity</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Cleaning</strong></td>
<td>Removing duplicates, handling null values, correcting typos</td>
<td>Basic</td>
</tr>
<tr>
<td><strong>Standardization</strong></td>
<td>Consistent date formats, normalized text case, unified units</td>
<td>Basic</td>
</tr>
<tr>
<td><strong>Validation</strong></td>
<td>Enforcing data types, range checks, referential integrity</td>
<td>Moderate</td>
</tr>
<tr>
<td><strong>Enrichment</strong></td>
<td>Adding derived fields, joining with reference data</td>
<td>Moderate</td>
</tr>
<tr>
<td><strong>Aggregation</strong></td>
<td>Summarizing transactions by day/week/month</td>
<td>Moderate</td>
</tr>
<tr>
<td><strong>Feature Engineering</strong></td>
<td>Creating ML features from raw signals</td>
<td>Advanced</td>
</tr>
<tr>
<td><strong>Complex Business Logic</strong></td>
<td>Multi-step calculations, conditional transformations</td>
<td>Advanced</td>
</tr>
</tbody>
</table>
<h4 id="the-etl-vs-elt-paradigm">The ETL vs. ELT Paradigm<a class="headerlink" href="#the-etl-vs-elt-paradigm" title="Permanent link">&para;</a></h4>
<p>Historically, transformations occurred during the data movement process itself—<strong>Extract, Transform, Load (ETL)</strong>. Data was extracted from sources, transformed in a dedicated processing system, and then loaded into the destination.</p>
<p>Modern cloud data warehouses have enabled a different approach—<strong>Extract, Load, Transform (ELT)</strong>. Raw data is loaded directly into the destination, and transformations occur within the powerful processing engines of cloud warehouses like Snowflake, BigQuery, or Redshift.</p>
<p>We will examine these paradigms thoroughly in Chapter 6.</p>
<hr />
<h3 id="126-stage-5-analysis-extracting-insights">1.2.6 Stage 5: Analysis — Extracting Insights<a class="headerlink" href="#126-stage-5-analysis-extracting-insights" title="Permanent link">&para;</a></h3>
<p>The analysis stage is where data scientists typically enter the picture. This encompasses:</p>
<ul>
<li><strong>Exploratory Data Analysis (EDA)</strong>: Understanding distributions, relationships, and anomalies</li>
<li><strong>Statistical Analysis</strong>: Hypothesis testing, significance testing, causal inference</li>
<li><strong>Machine Learning</strong>: Building predictive and prescriptive models</li>
<li><strong>Business Intelligence</strong>: Creating reports, dashboards, and visualizations</li>
</ul>
<p>While this stage is the traditional focus of data science education, its success depends entirely on the quality of the preceding stages.</p>
<hr />
<h3 id="127-stage-6-serving-delivering-value">1.2.7 Stage 6: Serving — Delivering Value<a class="headerlink" href="#127-stage-6-serving-delivering-value" title="Permanent link">&para;</a></h3>
<p>Analysis has no value unless its results reach decision-makers. The serving stage delivers insights through:</p>
<ul>
<li><strong>Dashboards and Reports</strong>: Self-service access to metrics and KPIs</li>
<li><strong>APIs</strong>: Programmatic access for applications</li>
<li><strong>Embedded Analytics</strong>: Insights integrated into operational systems</li>
<li><strong>ML Model Predictions</strong>: Real-time or batch scoring</li>
<li><strong>Alerts and Notifications</strong>: Proactive communication of important changes</li>
</ul>
<hr />
<h3 id="128-stage-7-maintenance-ensuring-reliability">1.2.8 Stage 7: Maintenance — Ensuring Reliability<a class="headerlink" href="#128-stage-7-maintenance-ensuring-reliability" title="Permanent link">&para;</a></h3>
<p>Data systems require ongoing care to remain reliable and trustworthy:</p>
<ul>
<li><strong>Monitoring</strong>: Tracking data freshness, quality metrics, and system health</li>
<li><strong>Alerting</strong>: Automated notification of anomalies or failures</li>
<li><strong>Documentation</strong>: Maintaining accurate metadata and lineage information</li>
<li><strong>Evolution</strong>: Updating systems as requirements change</li>
<li><strong>Incident Response</strong>: Diagnosing and resolving data issues</li>
</ul>
<hr />
<h3 id="129-stage-8-archival-managing-the-end-of-life">1.2.9 Stage 8: Archival — Managing the End of Life<a class="headerlink" href="#129-stage-8-archival-managing-the-end-of-life" title="Permanent link">&para;</a></h3>
<p>Data does not live forever. The archival stage addresses:</p>
<ul>
<li><strong>Retention Policies</strong>: How long different data types must be kept</li>
<li><strong>Cold Storage</strong>: Moving infrequently accessed data to cheaper storage tiers</li>
<li><strong>Deletion</strong>: Permanently removing data per policy or regulation</li>
<li><strong>Compliance</strong>: Meeting legal requirements like GDPR's "right to erasure"</li>
</ul>
<hr />
<h2 id="13-roles-in-the-data-ecosystem">1.3 Roles in the Data Ecosystem<a class="headerlink" href="#13-roles-in-the-data-ecosystem" title="Permanent link">&para;</a></h2>
<p>The data lifecycle involves multiple specialized roles. Understanding these roles—and how they interact—improves collaboration and helps you identify when to seek expertise.</p>
<h3 id="131-the-core-data-roles">1.3.1 The Core Data Roles<a class="headerlink" href="#131-the-core-data-roles" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Role</th>
<th>Primary Responsibility</th>
<th>Key Skills</th>
<th>Tools</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data Engineer</strong></td>
<td>Build and maintain data infrastructure</td>
<td>Python, SQL, distributed systems</td>
<td>Spark, Airflow, Kafka, Cloud platforms</td>
</tr>
<tr>
<td><strong>Data Scientist</strong></td>
<td>Extract insights and build models</td>
<td>Statistics, ML, programming</td>
<td>Python, R, SQL, ML frameworks</td>
</tr>
<tr>
<td><strong>Data Analyst</strong></td>
<td>Answer business questions with data</td>
<td>SQL, visualization, business acumen</td>
<td>SQL, Tableau, Excel, Looker</td>
</tr>
<tr>
<td><strong>Analytics Engineer</strong></td>
<td>Transform data for analysis</td>
<td>SQL, data modeling, software engineering</td>
<td>dbt, SQL, Git</td>
</tr>
<tr>
<td><strong>ML Engineer</strong></td>
<td>Deploy and scale ML systems</td>
<td>Software engineering, MLOps</td>
<td>Docker, Kubernetes, MLflow</td>
</tr>
<tr>
<td><strong>Data Architect</strong></td>
<td>Design overall data strategy</td>
<td>Systems design, governance</td>
<td>Architecture tools, cloud platforms</td>
</tr>
</tbody>
</table>
<h3 id="132-the-evolving-boundaries">1.3.2 The Evolving Boundaries<a class="headerlink" href="#132-the-evolving-boundaries" title="Permanent link">&para;</a></h3>
<p>These roles are not rigid silos. In practice:</p>
<ul>
<li>Data scientists increasingly need data engineering skills to be self-sufficient</li>
<li>Data engineers benefit from understanding analytical use cases</li>
<li>Analytics engineers emerged to bridge the gap between engineering and analysis</li>
<li>Small teams often combine multiple roles into "full-stack" data practitioners</li>
</ul>
<blockquote>
<p><strong>For Data Scientists</strong>: Developing data engineering competency makes you dramatically more effective. You can prototype pipelines, debug data issues, and work independently on smaller projects—while collaborating more effectively with specialists on larger ones.</p>
</blockquote>
<hr />
<h2 id="14-event-tracking-and-event-driven-architecture">1.4 Event Tracking and Event-Driven Architecture<a class="headerlink" href="#14-event-tracking-and-event-driven-architecture" title="Permanent link">&para;</a></h2>
<p>In the modern data landscape, <strong>events</strong> are the fundamental unit of behavioral data. Understanding event tracking is essential for any data scientist working with user behavior, product analytics, or real-time systems.</p>
<h3 id="141-what-is-an-event">1.4.1 What is an Event?<a class="headerlink" href="#141-what-is-an-event" title="Permanent link">&para;</a></h3>
<p>An event is a record of something that happened at a specific point in time. Unlike a database record that represents the current state of an entity, an event captures a discrete occurrence.</p>
<p><strong>The anatomy of an event:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>EVENT = WHAT happened + WHEN it happened + WHO did it + WHERE + CONTEXT
</code></pre></div>
<p>Consider this example of a well-structured event:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="p">{</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span><span class="nt">&quot;event_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;evt_8f14e45f-ceea-367a-a27d-f0c12e45bc&quot;</span><span class="p">,</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span><span class="nt">&quot;event_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;product_added_to_cart&quot;</span><span class="p">,</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-11-29T14:32:15.123Z&quot;</span><span class="p">,</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">  </span><span class="nt">&quot;user_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;usr_abc123&quot;</span><span class="p">,</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">  </span><span class="nt">&quot;anonymous_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;anon_device_fingerprint_xyz&quot;</span><span class="p">,</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">  </span><span class="nt">&quot;session_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sess_789xyz&quot;</span><span class="p">,</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">  </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">    </span><span class="nt">&quot;product_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;prod_456&quot;</span><span class="p">,</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">    </span><span class="nt">&quot;product_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Wireless Noise-Canceling Headphones&quot;</span><span class="p">,</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">    </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">249.99</span><span class="p">,</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">    </span><span class="nt">&quot;currency&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;USD&quot;</span><span class="p">,</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">    </span><span class="nt">&quot;quantity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="w">    </span><span class="nt">&quot;category&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Electronics/Audio&quot;</span><span class="p">,</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="w">    </span><span class="nt">&quot;brand&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SoundMax&quot;</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="w">  </span><span class="nt">&quot;context&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="w">    </span><span class="nt">&quot;page_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://shop.example.com/products/wireless-headphones&quot;</span><span class="p">,</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="w">    </span><span class="nt">&quot;page_title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Wireless Headphones - SoundMax&quot;</span><span class="p">,</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="w">    </span><span class="nt">&quot;referrer&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://www.google.com/search?q=best+wireless+headphones&quot;</span><span class="p">,</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a><span class="w">    </span><span class="nt">&quot;device&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a><span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mobile&quot;</span><span class="p">,</span>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="w">      </span><span class="nt">&quot;os&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;iOS&quot;</span><span class="p">,</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a><span class="w">      </span><span class="nt">&quot;os_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;17.1&quot;</span><span class="p">,</span>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a><span class="w">      </span><span class="nt">&quot;browser&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Safari&quot;</span><span class="p">,</span>
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a><span class="w">      </span><span class="nt">&quot;screen_width&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">390</span><span class="p">,</span>
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a><span class="w">      </span><span class="nt">&quot;screen_height&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">844</span>
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a><span class="w">    </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a><span class="w">      </span><span class="nt">&quot;country&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;United States&quot;</span><span class="p">,</span>
<a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a><span class="w">      </span><span class="nt">&quot;region&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;California&quot;</span><span class="p">,</span>
<a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a><span class="w">      </span><span class="nt">&quot;city&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;San Francisco&quot;</span><span class="p">,</span>
<a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a><span class="w">      </span><span class="nt">&quot;timezone&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;America/Los_Angeles&quot;</span>
<a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a><span class="w">    </span><span class="nt">&quot;campaign&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a><span class="w">      </span><span class="nt">&quot;source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;google&quot;</span><span class="p">,</span>
<a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a><span class="w">      </span><span class="nt">&quot;medium&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cpc&quot;</span><span class="p">,</span>
<a id="__codelineno-4-41" name="__codelineno-4-41" href="#__codelineno-4-41"></a><span class="w">      </span><span class="nt">&quot;campaign&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;holiday_sale_2025&quot;</span><span class="p">,</span>
<a id="__codelineno-4-42" name="__codelineno-4-42" href="#__codelineno-4-42"></a><span class="w">      </span><span class="nt">&quot;term&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;wireless headphones&quot;</span>
<a id="__codelineno-4-43" name="__codelineno-4-43" href="#__codelineno-4-43"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-4-44" name="__codelineno-4-44" href="#__codelineno-4-44"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-4-45" name="__codelineno-4-45" href="#__codelineno-4-45"></a>
<a id="__codelineno-4-46" name="__codelineno-4-46" href="#__codelineno-4-46"></a><span class="w">  </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-47" name="__codelineno-4-47" href="#__codelineno-4-47"></a><span class="w">    </span><span class="nt">&quot;sent_at&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-11-29T14:32:15.456Z&quot;</span><span class="p">,</span>
<a id="__codelineno-4-48" name="__codelineno-4-48" href="#__codelineno-4-48"></a><span class="w">    </span><span class="nt">&quot;received_at&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-11-29T14:32:15.789Z&quot;</span><span class="p">,</span>
<a id="__codelineno-4-49" name="__codelineno-4-49" href="#__codelineno-4-49"></a><span class="w">    </span><span class="nt">&quot;sdk_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.5.1&quot;</span><span class="p">,</span>
<a id="__codelineno-4-50" name="__codelineno-4-50" href="#__codelineno-4-50"></a><span class="w">    </span><span class="nt">&quot;library&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;analytics.js&quot;</span>
<a id="__codelineno-4-51" name="__codelineno-4-51" href="#__codelineno-4-51"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-4-52" name="__codelineno-4-52" href="#__codelineno-4-52"></a><span class="p">}</span>
</code></pre></div>
<h3 id="142-the-event-driven-architecture">1.4.2 The Event-Driven Architecture<a class="headerlink" href="#142-the-event-driven-architecture" title="Permanent link">&para;</a></h3>
<p>Events flow through a system architecture designed to capture, transport, and process them reliably at scale.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>┌─────────────────────────────────────────────────────────────────────────────────┐
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>│                         EVENT-DRIVEN ARCHITECTURE                                │
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>│                                                                                  │
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>│  ┌────────────────────────────────────────────────────────────────────────────┐ │
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>│  │                          EVENT PRODUCERS                                    │ │
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>│  │                                                                             │ │
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>│  │   ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐   ┌─────────┐     │ │
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>│  │   │   Web   │   │ Mobile  │   │ Backend │   │   IoT   │   │  Third  │     │ │
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>│  │   │  Apps   │   │  Apps   │   │Services │   │ Devices │   │  Party  │     │ │
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>│  │   └────┬────┘   └────┬────┘   └────┬────┘   └────┬────┘   └────┬────┘     │ │
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>│  └────────┼─────────────┼─────────────┼─────────────┼─────────────┼──────────┘ │
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>│           │             │             │             │             │            │
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>│           └─────────────┴──────┬──────┴─────────────┴─────────────┘            │
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>│                                │                                                │
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>│                                ▼                                                │
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>│  ┌────────────────────────────────────────────────────────────────────────────┐ │
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>│  │                       EVENT COLLECTION LAYER                                │ │
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>│  │                                                                             │ │
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>│  │   • SDK/Tracking Libraries (Segment, Amplitude, Mixpanel, custom)          │ │
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>│  │   • API Gateways and Webhook Receivers                                      │ │
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>│  │   • Validation, Enrichment, and Routing                                     │ │
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>│  │                                                                             │ │
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>│  └────────────────────────────────────┬───────────────────────────────────────┘ │
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>│                                       │                                         │
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>│                                       ▼                                         │
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>│  ┌────────────────────────────────────────────────────────────────────────────┐ │
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>│  │                       EVENT STREAMING LAYER                                 │ │
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>│  │                                                                             │ │
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>│  │   ┌──────────────────────────────────────────────────────────────────────┐ │ │
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>│  │   │                    MESSAGE QUEUE / EVENT BUS                          │ │ │
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>│  │   │                                                                       │ │ │
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a>│  │   │    Apache Kafka  •  Amazon Kinesis  •  Google Pub/Sub  •  RabbitMQ   │ │ │
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a>│  │   │                                                                       │ │ │
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a>│  │   │    • Durability: Events persisted to disk                            │ │ │
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a>│  │   │    • Scalability: Partitioned for parallel processing                │ │ │
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a>│  │   │    • Decoupling: Producers and consumers operate independently       │ │ │
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a>│  │   └──────────────────────────────────────────────────────────────────────┘ │ │
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a>│  └────────────────────────────────────┬───────────────────────────────────────┘ │
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a>│                                       │                                         │
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a>│           ┌───────────────────────────┼───────────────────────────┐             │
<a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a>│           │                           │                           │             │
<a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a>│           ▼                           ▼                           ▼             │
<a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a>│  ┌─────────────────┐       ┌─────────────────┐       ┌─────────────────┐       │
<a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a>│  │   REAL-TIME     │       │     BATCH       │       │    DERIVED      │       │
<a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a>│  │   PROCESSING    │       │    STORAGE      │       │     DATA        │       │
<a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a>│  │                 │       │                 │       │                 │       │
<a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a>│  │ • Live dashboards│      │ • Data Lake     │       │ • Data Warehouse│       │
<a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a>│  │ • Alerting      │       │ • Raw event     │       │ • Aggregated    │       │
<a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a>│  │ • Real-time ML  │       │   archive       │       │   tables        │       │
<a id="__codelineno-5-50" name="__codelineno-5-50" href="#__codelineno-5-50"></a>│  │ • Fraud detection│      │ • Parquet files │       │ • ML features   │       │
<a id="__codelineno-5-51" name="__codelineno-5-51" href="#__codelineno-5-51"></a>│  └─────────────────┘       └─────────────────┘       └─────────────────┘       │
<a id="__codelineno-5-52" name="__codelineno-5-52" href="#__codelineno-5-52"></a>│                                                                                  │
<a id="__codelineno-5-53" name="__codelineno-5-53" href="#__codelineno-5-53"></a>└─────────────────────────────────────────────────────────────────────────────────┘
</code></pre></div>
<h3 id="143-designing-an-event-taxonomy">1.4.3 Designing an Event Taxonomy<a class="headerlink" href="#143-designing-an-event-taxonomy" title="Permanent link">&para;</a></h3>
<p>A well-designed event taxonomy—the organized catalog of all events your system tracks—is crucial for maintainability and analytical utility.</p>
<h4 id="event-naming-conventions">Event Naming Conventions<a class="headerlink" href="#event-naming-conventions" title="Permanent link">&para;</a></h4>
<p>Consistency in naming enables self-service analytics and reduces confusion:</p>
<p><strong>Recommended Pattern: <code>object_action</code></strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>✓ product_viewed
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>✓ product_added_to_cart
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>✓ cart_viewed
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>✓ checkout_started
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>✓ checkout_step_completed
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>✓ order_completed
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>✓ order_refunded
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>✓ user_signed_up
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>✓ user_logged_in
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>✓ subscription_started
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>✓ subscription_cancelled
</code></pre></div>
<p><strong>Patterns to Avoid:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>✗ click                      (too generic)
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>✗ event_1, event_2           (meaningless)
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>✗ productAddedToCart         (inconsistent casing)
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>✗ add_to_cart_button_clicked_on_product_detail_page  (too specific)
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>✗ tracking_event             (redundant)
</code></pre></div>
<h4 id="event-categories">Event Categories<a class="headerlink" href="#event-categories" title="Permanent link">&para;</a></h4>
<p>Organizing events into categories improves discoverability:</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Purpose</th>
<th>Example Events</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Acquisition</strong></td>
<td>How users arrive</td>
<td><code>campaign_clicked</code>, <code>referral_received</code></td>
</tr>
<tr>
<td><strong>Activation</strong></td>
<td>First value moments</td>
<td><code>user_signed_up</code>, <code>onboarding_completed</code></td>
</tr>
<tr>
<td><strong>Engagement</strong></td>
<td>Core product usage</td>
<td><code>feature_used</code>, <code>content_viewed</code></td>
</tr>
<tr>
<td><strong>Conversion</strong></td>
<td>Revenue events</td>
<td><code>subscription_started</code>, <code>purchase_completed</code></td>
</tr>
<tr>
<td><strong>Retention</strong></td>
<td>Return behavior</td>
<td><code>user_returned</code>, <code>streak_maintained</code></td>
</tr>
<tr>
<td><strong>System</strong></td>
<td>Technical events</td>
<td><code>error_occurred</code>, <code>page_loaded</code></td>
</tr>
</tbody>
</table>
<h3 id="144-event-properties-and-context">1.4.4 Event Properties and Context<a class="headerlink" href="#144-event-properties-and-context" title="Permanent link">&para;</a></h3>
<p>The value of an event lies not just in knowing it occurred, but in the rich context captured alongside it.</p>
<h4 id="properties-vs-context">Properties vs. Context<a class="headerlink" href="#properties-vs-context" title="Permanent link">&para;</a></h4>
<p><strong>Properties</strong> are specific to the event type:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1">// For &quot;product_added_to_cart&quot;</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">  </span><span class="nt">&quot;product_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;prod_456&quot;</span><span class="p">,</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">  </span><span class="nt">&quot;product_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Wireless Headphones&quot;</span><span class="p">,</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">  </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">249.99</span><span class="p">,</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">  </span><span class="nt">&quot;quantity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">  </span><span class="nt">&quot;category&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Electronics&quot;</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Context</strong> is captured automatically for all events:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">// Same for every event</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="nt">&quot;context&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">  </span><span class="nt">&quot;page_url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">  </span><span class="nt">&quot;device&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mobile&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;os&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;iOS&quot;</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">  </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;country&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;US&quot;</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">  </span><span class="nt">&quot;campaign&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;google&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;medium&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cpc&quot;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="p">}</span>
</code></pre></div>
<h4 id="identity-resolution">Identity Resolution<a class="headerlink" href="#identity-resolution" title="Permanent link">&para;</a></h4>
<p>Users interact with products across devices and sessions, often before creating an account. Event systems must handle:</p>
<ul>
<li><strong>Anonymous ID</strong>: Device or browser identifier before login</li>
<li><strong>User ID</strong>: Authenticated identifier after login</li>
<li><strong>Session ID</strong>: Groups events within a single visit</li>
<li><strong>Identity Stitching</strong>: Connecting anonymous activity to known users after authentication</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1">// Before login</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="p">{</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">  </span><span class="nt">&quot;event_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;product_viewed&quot;</span><span class="p">,</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">  </span><span class="nt">&quot;anonymous_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;anon_device_123&quot;</span><span class="p">,</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">  </span><span class="nt">&quot;user_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="p">}</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="c1">// After login (same session)</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="p">{</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">  </span><span class="nt">&quot;event_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user_logged_in&quot;</span><span class="p">,</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">  </span><span class="nt">&quot;anonymous_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;anon_device_123&quot;</span><span class="p">,</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">  </span><span class="nt">&quot;user_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;usr_abc456&quot;</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="p">}</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="c1">// Subsequent events (user identified)</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="p">{</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">  </span><span class="nt">&quot;event_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;product_purchased&quot;</span><span class="p">,</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="w">  </span><span class="nt">&quot;anonymous_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;anon_device_123&quot;</span><span class="p">,</span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="w">  </span><span class="nt">&quot;user_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;usr_abc456&quot;</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="p">}</span>
</code></pre></div>
<h3 id="145-from-events-to-features-the-data-science-connection">1.4.5 From Events to Features: The Data Science Connection<a class="headerlink" href="#145-from-events-to-features-the-data-science-connection" title="Permanent link">&para;</a></h3>
<p>For data scientists, events are the raw material for behavioral features:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="c1"># Raw events</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">events</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>    <span class="p">{</span><span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="s2">&quot;u1&quot;</span><span class="p">,</span> <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;page_view&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-01-01 10:00:00&quot;</span><span class="p">,</span> 
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>     <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="s2">&quot;home&quot;</span><span class="p">}},</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>    <span class="p">{</span><span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="s2">&quot;u1&quot;</span><span class="p">,</span> <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;product_viewed&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-01-01 10:05:00&quot;</span><span class="p">,</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>     <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;product_id&quot;</span><span class="p">:</span> <span class="s2">&quot;p1&quot;</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mf">99.99</span><span class="p">}},</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>    <span class="p">{</span><span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="s2">&quot;u1&quot;</span><span class="p">,</span> <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;add_to_cart&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-01-01 10:07:00&quot;</span><span class="p">,</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>     <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;product_id&quot;</span><span class="p">:</span> <span class="s2">&quot;p1&quot;</span><span class="p">}},</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>    <span class="p">{</span><span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="s2">&quot;u1&quot;</span><span class="p">,</span> <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;purchase&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-01-01 10:15:00&quot;</span><span class="p">,</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>     <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;order_total&quot;</span><span class="p">:</span> <span class="mf">99.99</span><span class="p">}},</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>    <span class="p">{</span><span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="s2">&quot;u2&quot;</span><span class="p">,</span> <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;page_view&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-01-01 11:00:00&quot;</span><span class="p">,</span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>     <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="s2">&quot;home&quot;</span><span class="p">}},</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>    <span class="p">{</span><span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="s2">&quot;u2&quot;</span><span class="p">,</span> <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;page_view&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-01-01 11:30:00&quot;</span><span class="p">,</span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>     <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="s2">&quot;pricing&quot;</span><span class="p">}},</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="p">])</span>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="c1"># Transform to user-level features for ML</span>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="n">user_features</span> <span class="o">=</span> <span class="n">events</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a>    <span class="n">total_events</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;event&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">),</span>
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a>    <span class="n">unique_event_types</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;event&#39;</span><span class="p">,</span> <span class="s1">&#39;nunique&#39;</span><span class="p">),</span>
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a>    <span class="n">session_duration_minutes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> 
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a>        <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">seconds</span> <span class="o">/</span> <span class="mi">60</span><span class="p">),</span>
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a>    <span class="n">viewed_products</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;event&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;product_viewed&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()),</span>
<a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a>    <span class="n">made_purchase</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;event&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;purchase&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
<a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a>
<a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a><span class="nb">print</span><span class="p">(</span><span class="n">user_features</span><span class="p">)</span>
</code></pre></div>
<p>Output:
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>  user_id  total_events  unique_event_types  session_duration_minutes  viewed_products  made_purchase
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>0      u1             4                   4                      15.0                1           True
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>1      u2             2                   1                      30.0                0          False
</code></pre></div></p>
<hr />
<h2 id="15-summary-and-key-concepts">1.5 Summary and Key Concepts<a class="headerlink" href="#15-summary-and-key-concepts" title="Permanent link">&para;</a></h2>
<p>This chapter established the foundational concepts necessary for understanding data engineering:</p>
<h3 id="the-data-lifecycle">The Data Lifecycle<a class="headerlink" href="#the-data-lifecycle" title="Permanent link">&para;</a></h3>
<p>Data flows through eight stages: <strong>Generation → Collection → Storage → Transformation → Analysis → Serving → Maintenance → Archival</strong>. Understanding this complete journey enables you to trace data quality issues, design better systems, and collaborate effectively across roles.</p>
<h3 id="roles-in-the-data-ecosystem">Roles in the Data Ecosystem<a class="headerlink" href="#roles-in-the-data-ecosystem" title="Permanent link">&para;</a></h3>
<p>Multiple specialized roles contribute to the data lifecycle. As a data scientist, developing data engineering literacy makes you more effective and self-sufficient.</p>
<h3 id="events-as-foundational-data">Events as Foundational Data<a class="headerlink" href="#events-as-foundational-data" title="Permanent link">&para;</a></h3>
<p>Modern behavioral data is captured through events—discrete records of actions with timestamps, identities, and rich contextual properties. Well-designed event architectures enable powerful analytics and machine learning.</p>
<hr />
<h2 id="16-further-reading-and-resources">1.6 Further Reading and Resources<a class="headerlink" href="#16-further-reading-and-resources" title="Permanent link">&para;</a></h2>
<h3 id="books">Books<a class="headerlink" href="#books" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Reis, J. &amp; Housley, M. (2022). <em>Fundamentals of Data Engineering</em>.</strong> O'Reilly Media. The definitive introduction to data engineering concepts and practices.</li>
<li><strong>Kleppmann, M. (2017). <em>Designing Data-Intensive Applications</em>.</strong> O'Reilly Media. Deep exploration of the principles underlying modern data systems.</li>
</ul>
<h3 id="papers">Papers<a class="headerlink" href="#papers" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Zha, D. et al. (2023). "Data-centric Artificial Intelligence: A Survey."</strong> arXiv:2303.10158. Comprehensive overview of data-centric approaches to AI. https://arxiv.org/abs/2303.10158</li>
<li><strong>Nazabal, A. et al. (2020). "Data Engineering for Data Analytics: A Classification of the Issues, and Case Studies."</strong> arXiv:2004.12929. Classification of data engineering tasks with practical examples. https://arxiv.org/abs/2004.12929</li>
</ul>
<h3 id="online-resources">Online Resources<a class="headerlink" href="#online-resources" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Data Engineering Handbook</strong> (GitHub): Comprehensive collection of resources, tools, and learning paths. https://github.com/DataExpert-io/data-engineer-handbook</li>
<li><strong>DataTalks.Club Data Engineering Zoomcamp</strong>: Free, project-based course covering modern data engineering tools and practices. https://github.com/DataTalksClub/data-engineering-zoomcamp</li>
</ul>
<hr />
<h2 id="17-exercises">1.7 Exercises<a class="headerlink" href="#17-exercises" title="Permanent link">&para;</a></h2>
<p><strong>Exercise 1.1: Data Lifecycle Mapping</strong>
Choose a dataset you have worked with recently. Trace its journey through the data lifecycle:
- Where was the data originally generated?
- How was it collected and by whom?
- Where is it stored?
- What transformations were applied before you received it?
- What limitations might exist due to decisions made at each stage?</p>
<p><strong>Exercise 1.2: Event Schema Design</strong>
Design an event tracking schema for one of the following scenarios:
- A music streaming application (like Spotify)
- A food delivery service (like DoorDash)
- An online learning platform (like Coursera)</p>
<p>For each scenario:
1. Identify 10-15 key events to track
2. Define properties for each event
3. Document your naming conventions
4. Consider what context should be captured automatically</p>
<p><strong>Exercise 1.3: Event to Feature Transformation</strong>
Given the following raw events, create five user-level features that could be useful for predicting user churn:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="p">{</span><span class="nt">&quot;user_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;u1&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;app_opened&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-01T10:00:00Z&quot;</span><span class="p">}</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="p">{</span><span class="nt">&quot;user_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;u1&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;content_viewed&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-01T10:05:00Z&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;content_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;video&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;duration_seconds&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">}}</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="p">{</span><span class="nt">&quot;user_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;u1&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;content_liked&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-01T10:10:00Z&quot;</span><span class="p">}</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="p">{</span><span class="nt">&quot;user_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;u1&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;app_closed&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-01T10:30:00Z&quot;</span><span class="p">}</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="p">{</span><span class="nt">&quot;user_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;u2&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;app_opened&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-01T11:00:00Z&quot;</span><span class="p">}</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="p">{</span><span class="nt">&quot;user_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;u2&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error_occurred&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-01T11:01:00Z&quot;</span><span class="p">}</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="p">{</span><span class="nt">&quot;user_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;u2&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;event&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;app_closed&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-01T11:02:00Z&quot;</span><span class="p">}</span>
</code></pre></div>
<hr />
<h1 id="chapter-2-data-types-and-file-formats-the-building-blocks">Chapter 2: Data Types and File Formats — The Building Blocks<a class="headerlink" href="#chapter-2-data-types-and-file-formats-the-building-blocks" title="Permanent link">&para;</a></h1>
<blockquote>
<p><em>"The goal is to turn data into information, and information into insight."</em>
— Carly Fiorina, former CEO of Hewlett-Packard</p>
</blockquote>
<hr />
<h2 id="21-introduction-why-format-matters">2.1 Introduction: Why Format Matters<a class="headerlink" href="#21-introduction-why-format-matters" title="Permanent link">&para;</a></h2>
<p>When you load a dataset into pandas with <code>pd.read_csv()</code>, a complex series of operations occurs behind the scenes. The file is read from disk, bytes are decoded into characters, delimiters are detected, columns are parsed, and data types are inferred. This seemingly simple operation embodies fundamental decisions about how data is represented, stored, and accessed.</p>
<p>The choice of data format affects:</p>
<ul>
<li><strong>Storage costs</strong>: Some formats are 10x more compact than others</li>
<li><strong>Query performance</strong>: The right format can make queries 100x faster</li>
<li><strong>Processing efficiency</strong>: Format determines how data flows through pipelines</li>
<li><strong>Interoperability</strong>: Different systems support different formats</li>
<li><strong>Schema evolution</strong>: Some formats handle changes gracefully; others break</li>
</ul>
<p>This chapter provides a comprehensive understanding of data types and file formats—knowledge that will inform every data engineering decision you make.</p>
<hr />
<h2 id="22-the-data-structure-spectrum">2.2 The Data Structure Spectrum<a class="headerlink" href="#22-the-data-structure-spectrum" title="Permanent link">&para;</a></h2>
<p>Not all data fits neatly into spreadsheet rows and columns. Understanding the spectrum of data structures helps you choose appropriate storage and processing strategies.</p>
<h3 id="221-structured-data">2.2.1 Structured Data<a class="headerlink" href="#221-structured-data" title="Permanent link">&para;</a></h3>
<p><strong>Structured data</strong> conforms to a fixed schema with predefined columns and data types. Every record has the same fields in the same order.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>┌────────────┬─────────────────┬─────────┬────────────┬───────────┐
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>│ customer_id│ name            │ age     │ email      │ signup_dt │
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>├────────────┼─────────────────┼─────────┼────────────┼───────────┤
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>│ 1          │ Alice Smith     │ 28      │ alice@...  │ 2024-01-15│
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>│ 2          │ Bob Johnson     │ 35      │ bob@...    │ 2024-02-20│
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>│ 3          │ Carol Williams  │ 42      │ carol@...  │ 2024-03-10│
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>└────────────┴─────────────────┴─────────┴────────────┴───────────┘
</code></pre></div>
<p><strong>Characteristics:</strong>
- Schema defined before data insertion (schema-on-write)
- Fixed columns with enforced data types
- Naturally maps to relational database tables
- Easily queried with SQL
- Efficient storage due to predictable structure</p>
<p><strong>Common sources:</strong> Relational databases, ERP systems, financial records, CRM data</p>
<h3 id="222-semi-structured-data">2.2.2 Semi-Structured Data<a class="headerlink" href="#222-semi-structured-data" title="Permanent link">&para;</a></h3>
<p><strong>Semi-structured data</strong> has some organizational properties but does not conform to a rigid schema. It is self-describing, with tags or keys that identify data elements.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="p">{</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">  </span><span class="nt">&quot;customer_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Alice Smith&quot;</span><span class="p">,</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">  </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">  </span><span class="nt">&quot;contacts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">    </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alice@example.com&quot;</span><span class="p">,</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">    </span><span class="nt">&quot;phone&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;+1-555-0123&quot;</span><span class="p">,</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">    </span><span class="nt">&quot;preferences&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">      </span><span class="nt">&quot;newsletter&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">      </span><span class="nt">&quot;sms&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w">  </span><span class="nt">&quot;orders&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;o1&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;total&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">150.00</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;o2&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;total&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">89.99</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">}</span>
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="w">  </span><span class="nt">&quot;tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;premium&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;early_adopter&quot;</span><span class="p">]</span>
<a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Characteristics:</strong>
- Flexible schema (fields can vary between records)
- Supports nested structures (objects within objects)
- Self-describing (keys explain the data)
- Schema can evolve without breaking existing data
- Requires more sophisticated querying</p>
<p><strong>Common sources:</strong> JSON APIs, event tracking data, log files, NoSQL databases, configuration files</p>
<h3 id="223-unstructured-data">2.2.3 Unstructured Data<a class="headerlink" href="#223-unstructured-data" title="Permanent link">&para;</a></h3>
<p><strong>Unstructured data</strong> lacks any predefined organizational structure. It must be processed or analyzed to extract meaningful information.</p>
<p><strong>Examples:</strong>
- <strong>Text</strong>: Emails, documents, social media posts, customer reviews
- <strong>Images</strong>: Photographs, scanned documents, medical imaging
- <strong>Audio</strong>: Call recordings, podcasts, voice messages
- <strong>Video</strong>: Surveillance footage, user-generated content, training videos</p>
<p><strong>Characteristics:</strong>
- No inherent schema
- Requires specialized processing (NLP, computer vision, etc.)
- Often the largest volume of organizational data
- High potential value, but difficult to extract</p>
<p><strong>Processing unstructured data:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># Text analysis example</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="n">raw_text</span> <span class="o">=</span> <span class="s2">&quot;I absolutely love this product! Fast shipping and great quality.&quot;</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c1"># After NLP processing, we extract structured information:</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="n">processed</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>    <span class="s2">&quot;sentiment&quot;</span><span class="p">:</span> <span class="s2">&quot;positive&quot;</span><span class="p">,</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>    <span class="s2">&quot;sentiment_score&quot;</span><span class="p">:</span> <span class="mf">0.92</span><span class="p">,</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>    <span class="s2">&quot;topics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;product_quality&quot;</span><span class="p">,</span> <span class="s2">&quot;shipping&quot;</span><span class="p">],</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>    <span class="s2">&quot;entities&quot;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>    <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="s2">&quot;en&quot;</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="p">}</span>
</code></pre></div>
<h3 id="224-the-queryability-spectrum">2.2.4 The Queryability Spectrum<a class="headerlink" href="#224-the-queryability-spectrum" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>STRUCTURED                SEMI-STRUCTURED              UNSTRUCTURED
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>    │                           │                            │
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>    │  SELECT * FROM users      │  $.orders[*].total         │  [Requires ML/AI]
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>    │  WHERE age &gt; 25           │  WHERE name = &#39;Alice&#39;      │  
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>    │                           │                            │
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>    ◀──────────────────────────────────────────────────────────▶
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>    Easy to Query                                    Difficult to Query
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>    Rigid Schema                                     No Schema
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>    Small Storage                                    Large Storage
</code></pre></div>
<hr />
<h2 id="23-file-formats-a-comprehensive-guide">2.3 File Formats: A Comprehensive Guide<a class="headerlink" href="#23-file-formats-a-comprehensive-guide" title="Permanent link">&para;</a></h2>
<p>The choice of file format is one of the most consequential decisions in data engineering. This section provides deep coverage of the formats you will encounter.</p>
<h3 id="231-text-based-formats">2.3.1 Text-Based Formats<a class="headerlink" href="#231-text-based-formats" title="Permanent link">&para;</a></h3>
<h4 id="csv-comma-separated-values">CSV (Comma-Separated Values)<a class="headerlink" href="#csv-comma-separated-values" title="Permanent link">&para;</a></h4>
<p>CSV is the oldest and most universal data exchange format. Its simplicity is both its greatest strength and its most significant limitation.</p>
<p><strong>Structure:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>customer_id,name,age,signup_date,is_active
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>1,Alice Smith,28,2024-01-15,true
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>2,&quot;Johnson, Bob&quot;,35,2024-02-20,true
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>3,Carol Williams,42,2024-03-10,false
</code></pre></div></p>
<p><strong>Technical Details:</strong>
- <strong>Encoding</strong>: Typically UTF-8, but varies (beware of Excel's default encoding)
- <strong>Delimiter</strong>: Comma by default, but tab (<code>\t</code>) and pipe (<code>|</code>) are common alternatives
- <strong>Quoting</strong>: Fields containing delimiters or newlines must be quoted
- <strong>Headers</strong>: First row typically contains column names (but not guaranteed)
- <strong>Types</strong>: All values stored as strings; types must be inferred or specified</p>
<p><strong>Advantages:</strong>
- Universal compatibility (every tool can read CSV)
- Human readable and editable
- Simple to generate and parse
- No dependencies or special libraries required</p>
<p><strong>Disadvantages:</strong></p>
<p>As noted in technical discussions: "CSV is just a string, meaning the dataset is larger by storing all characters according to the file-encoding; there is no type-information or schema associated with the data, and it will always be parsed while deserialized" (Stack Overflow, 2022).</p>
<p>Additional limitations:
- No standard specification (many dialects exist)
- No support for nested or hierarchical data
- Poor compression (text is verbose)
- Ambiguous handling of null values
- Date/time formats vary wildly
- Encoding issues are common</p>
<p><strong>When to use:</strong>
- Small datasets (under 100MB)
- Data exchange with non-technical stakeholders
- Legacy system integration
- Quick prototyping and exploration</p>
<p><strong>Python usage:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="c1"># Reading with explicit options for reliability</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>    <span class="s1">&#39;data.csv&#39;</span><span class="p">,</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>    <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>    <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;customer_id&#39;</span><span class="p">:</span> <span class="s1">&#39;int32&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">},</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>    <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;signup_date&#39;</span><span class="p">],</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>    <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;NULL&#39;</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">]</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="p">)</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="c1"># Writing with consistent formatting</span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;output.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></p>
<hr />
<h4 id="json-javascript-object-notation">JSON (JavaScript Object Notation)<a class="headerlink" href="#json-javascript-object-notation" title="Permanent link">&para;</a></h4>
<p>JSON emerged from JavaScript but has become the lingua franca of web APIs and configuration files. Its ability to represent nested structures makes it far more expressive than CSV.</p>
<p><strong>Structure:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="p">{</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">  </span><span class="nt">&quot;customers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">      </span><span class="nt">&quot;customer_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Alice Smith&quot;</span><span class="p">,</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">      </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">      </span><span class="nt">&quot;contacts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">        </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alice@example.com&quot;</span><span class="p">,</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="w">        </span><span class="nt">&quot;phone&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;+1-555-0123&quot;</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="w">      </span><span class="p">},</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="w">      </span><span class="nt">&quot;orders&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="w">        </span><span class="p">{</span><span class="nt">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;o1&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;total&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">150.00</span><span class="p">},</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="w">        </span><span class="p">{</span><span class="nt">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;o2&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;total&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">89.99</span><span class="p">}</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="w">      </span><span class="p">]</span>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="w">  </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="w">    </span><span class="nt">&quot;extracted_at&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-11-29T10:30:00Z&quot;</span><span class="p">,</span>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="w">    </span><span class="nt">&quot;record_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="p">}</span>
</code></pre></div></p>
<p><strong>Technical Details:</strong>
- <strong>Data types</strong>: strings, numbers, booleans, null, arrays, objects
- <strong>Encoding</strong>: Must be UTF-8 (per RFC 8259)
- <strong>No comments</strong>: JSON does not support comments (though some parsers allow them)
- <strong>Strict syntax</strong>: Trailing commas and single quotes are invalid</p>
<p><strong>Variants:</strong>
- <strong>JSON Lines (JSONL/NDJSON)</strong>: One JSON object per line, enabling streaming
- <strong>GeoJSON</strong>: JSON format for geographic data
- <strong>JSON Schema</strong>: Specification for validating JSON structure</p>
<p><strong>Advantages:</strong>
- Human readable (more so than CSV for complex data)
- Native support for nested structures
- Self-describing (keys provide context)
- Universal support in programming languages
- Natural fit for API responses</p>
<p><strong>Disadvantages:</strong>
- Verbose (keys repeated for every record)
- No native date/time type (dates are strings)
- Slow for large-scale analytics
- Memory-intensive for large files (must often parse entirely)</p>
<p><strong>When to use:</strong>
- API responses and requests
- Configuration files
- Document storage
- Data interchange between systems
- Event data (before analytical processing)</p>
<p><strong>Python usage:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">json_normalize</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="c1"># Reading JSON</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="c1"># Flattening nested JSON to DataFrame</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="n">df</span> <span class="o">=</span> <span class="n">json_normalize</span><span class="p">(</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;customers&#39;</span><span class="p">],</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>    <span class="n">record_path</span><span class="o">=</span><span class="s1">&#39;orders&#39;</span><span class="p">,</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>    <span class="n">meta</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;customer_id&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;contacts&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">]],</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>    <span class="n">meta_prefix</span><span class="o">=</span><span class="s1">&#39;customer_&#39;</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="p">)</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="c1"># Reading JSON Lines (streaming-friendly)</span>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;data.jsonl&#39;</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="c1"># Writing JSON</span>
<a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a><span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;output.json&#39;</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;iso&#39;</span><span class="p">)</span>
</code></pre></div></p>
<hr />
<h3 id="232-binary-columnar-formats">2.3.2 Binary Columnar Formats<a class="headerlink" href="#232-binary-columnar-formats" title="Permanent link">&para;</a></h3>
<p>Binary columnar formats represent a paradigm shift from row-based storage. They are essential for modern analytics and big data processing.</p>
<h4 id="understanding-columnar-storage">Understanding Columnar Storage<a class="headerlink" href="#understanding-columnar-storage" title="Permanent link">&para;</a></h4>
<p>The fundamental insight of columnar storage is that analytical queries typically access many rows but few columns:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1">-- This query touches only 2 columns out of potentially dozens</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="n">price</span><span class="p">),</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="k">FROM</span><span class="w"> </span><span class="n">transactions</span><span class="w"> </span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">transaction_date</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;2025-01-01&#39;</span>
</code></pre></div>
<p><strong>Row-based storage (CSV, Avro):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>Row 1: [id=1, name=&quot;Alice&quot;, age=28, city=&quot;NYC&quot;, salary=75000, ...]
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>Row 2: [id=2, name=&quot;Bob&quot;, age=35, city=&quot;LA&quot;, salary=82000, ...]
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>Row 3: [id=3, name=&quot;Carol&quot;, age=42, city=&quot;Chicago&quot;, salary=91000, ...]
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>To read &#39;age&#39; column: Must scan through entire rows
</code></pre></div></p>
<p><strong>Column-based storage (Parquet, ORC):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>id column:     [1, 2, 3, 4, 5, ...]
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>name column:   [&quot;Alice&quot;, &quot;Bob&quot;, &quot;Carol&quot;, ...]
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>age column:    [28, 35, 42, ...]    ← Read only this!
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>city column:   [&quot;NYC&quot;, &quot;LA&quot;, &quot;Chicago&quot;, ...]
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>salary column: [75000, 82000, 91000, ...]
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>To read &#39;age&#39; column: Read only the age column block
</code></pre></div></p>
<p><strong>Benefits of columnar storage:</strong>
1. <strong>Column pruning</strong>: Read only the columns needed for a query
2. <strong>Better compression</strong>: Similar values in a column compress well together
3. <strong>Vectorized processing</strong>: CPUs can process columns more efficiently
4. <strong>Predicate pushdown</strong>: Skip entire row groups based on column statistics</p>
<hr />
<h4 id="parquet">Parquet<a class="headerlink" href="#parquet" title="Permanent link">&para;</a></h4>
<p>Apache Parquet is the dominant columnar format for analytics and the default format for Apache Spark. Understanding Parquet is essential for any data practitioner.</p>
<p><strong>File Structure:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>┌─────────────────────────────────────────────────────────────────────────┐
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>│                           PARQUET FILE                                   │
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>│                                                                          │
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>│  ┌───────────────────────────────────────────────────────────────────┐  │
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>│  │                        ROW GROUP 1                                 │  │
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                │  │
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>│  │  │ Column Chunk│  │ Column Chunk│  │ Column Chunk│                │  │
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>│  │  │   (id)      │  │   (name)    │  │   (age)     │                │  │
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>│  │  │             │  │             │  │             │                │  │
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>│  │  │ • Data Pages│  │ • Data Pages│  │ • Data Pages│                │  │
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>│  │  │ • Dict Page │  │ • Dict Page │  │ • Statistics│                │  │
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>│  │  │ • Statistics│  │ • Statistics│  │   (min/max) │                │  │
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>│  │  └─────────────┘  └─────────────┘  └─────────────┘                │  │
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>│  └───────────────────────────────────────────────────────────────────┘  │
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a>│                                                                          │
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>│  ┌───────────────────────────────────────────────────────────────────┐  │
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a>│  │                        ROW GROUP 2                                 │  │
<a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a>│  │  (same structure as Row Group 1)                                   │  │
<a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a>│  └───────────────────────────────────────────────────────────────────┘  │
<a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a>│                                                                          │
<a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a>│  ┌───────────────────────────────────────────────────────────────────┐  │
<a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a>│  │                          FOOTER                                    │  │
<a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a>│  │  • File metadata                                                   │  │
<a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a>│  │  • Schema definition                                               │  │
<a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a>│  │  • Row group metadata                                              │  │
<a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a>│  │  • Column chunk locations                                          │  │
<a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a>│  │  • Key-value metadata (custom)                                     │  │
<a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a>│  └───────────────────────────────────────────────────────────────────┘  │
<a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a>└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>
<p><strong>Key Concepts:</strong></p>
<ul>
<li><strong>Row Groups</strong>: Horizontal partitions of the data (typically 128MB-1GB each)</li>
<li><strong>Column Chunks</strong>: A column's data within a row group</li>
<li><strong>Pages</strong>: The smallest unit of storage within a column chunk (typically 1MB)</li>
<li><strong>Footer</strong>: Metadata including schema, statistics, and locations</li>
</ul>
<p><strong>Schema Embedded in File:</strong></p>
<p>"Parquet stores the file schema in the file metadata. CSV files don't store file metadata, so readers need to either be supplied with the schema or the schema needs to be inferred" (MrPowers, Stack Overflow).</p>
<p><strong>Compression and Encoding:</strong></p>
<p>Parquet supports multiple compression codecs:
- <strong>Snappy</strong>: Fast compression/decompression, moderate ratio (default)
- <strong>Gzip</strong>: Higher compression ratio, slower
- <strong>LZ4</strong>: Very fast, lower ratio
- <strong>Zstd</strong>: Good balance of speed and ratio</p>
<p>Parquet also uses encoding schemes optimized for each data type:
- <strong>Dictionary encoding</strong>: For columns with repeated values
- <strong>Run-length encoding (RLE)</strong>: For sequences of repeated values
- <strong>Delta encoding</strong>: For sorted or incrementing values</p>
<p><strong>Predicate Pushdown:</strong></p>
<p>Parquet's column statistics enable query engines to skip irrelevant data:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c1"># Query: SELECT * FROM sales WHERE sale_date = &#39;2025-11-29&#39;</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="c1"># Row Group 1 statistics: sale_date min=&#39;2025-01-01&#39;, max=&#39;2025-06-30&#39;</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="c1">#   → SKIP (date not in range)</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="c1"># Row Group 2 statistics: sale_date min=&#39;2025-07-01&#39;, max=&#39;2025-12-31&#39;</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="c1">#   → READ (date might be in range)</span>
</code></pre></div>
<p><strong>When to use Parquet:</strong>
- Analytical queries and data warehousing
- Data lake storage
- Spark, Presto, Athena, BigQuery workloads
- Any dataset over 100MB used for analysis
- Long-term data archival</p>
<p>"Parquet is a default data file format for Spark" (Towards Data Science, 2023).</p>
<p><strong>Python usage:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pyarrow.parquet</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pq</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="c1"># Reading Parquet</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;data.parquet&#39;</span><span class="p">)</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="c1"># Reading specific columns only (column pruning)</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;data.parquet&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;customer_id&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;revenue&#39;</span><span class="p">])</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="c1"># Writing Parquet with options</span>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a>    <span class="s1">&#39;output.parquet&#39;</span><span class="p">,</span>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a>    <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;pyarrow&#39;</span><span class="p">,</span>
<a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a>    <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;snappy&#39;</span><span class="p">,</span>
<a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a>    <span class="n">index</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a><span class="p">)</span>
<a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a>
<a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a><span class="c1"># Advanced: Reading with filters (predicate pushdown)</span>
<a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span>
<a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a>    <span class="s1">&#39;data.parquet&#39;</span><span class="p">,</span>
<a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a>    <span class="n">filters</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="mi">2025</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;US&#39;</span><span class="p">,</span> <span class="s1">&#39;UK&#39;</span><span class="p">])]</span>
<a id="__codelineno-27-22" name="__codelineno-27-22" href="#__codelineno-27-22"></a><span class="p">)</span>
<a id="__codelineno-27-23" name="__codelineno-27-23" href="#__codelineno-27-23"></a>
<a id="__codelineno-27-24" name="__codelineno-27-24" href="#__codelineno-27-24"></a><span class="c1"># PySpark usage</span>
<a id="__codelineno-27-25" name="__codelineno-27-25" href="#__codelineno-27-25"></a><span class="n">spark_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s1">&#39;s3://bucket/data/&#39;</span><span class="p">)</span>
<a id="__codelineno-27-26" name="__codelineno-27-26" href="#__codelineno-27-26"></a><span class="n">spark_df</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s1">&#39;s3://bucket/output/&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">)</span>
</code></pre></div></p>
<hr />
<h4 id="avro">Avro<a class="headerlink" href="#avro" title="Permanent link">&para;</a></h4>
<p>Apache Avro is a row-based binary format designed for data serialization, particularly in streaming contexts.</p>
<p><strong>Structure:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>┌─────────────────────────────────────────────────────────────────────────┐
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>│                            AVRO FILE                                     │
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>│                                                                          │
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>│  ┌───────────────────────────────────────────────────────────────────┐  │
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>│  │                           HEADER                                   │  │
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>│  │  • Magic bytes (Obj1)                                              │  │
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>│  │  • Schema (JSON)                                                   │  │
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>│  │  • Sync marker (16 bytes)                                          │  │
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>│  └───────────────────────────────────────────────────────────────────┘  │
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>│                                                                          │
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>│  ┌───────────────────────────────────────────────────────────────────┐  │
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>│  │                        DATA BLOCK 1                                │  │
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>│  │  • Object count                                                    │  │
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a>│  │  • Serialized objects (compressed)                                 │  │
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a>│  │  • Sync marker                                                     │  │
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a>│  │                                                                    │  │
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a>│  │  Row 1: [1, &quot;Alice&quot;, 28, &quot;2024-01-15&quot;]                            │  │
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a>│  │  Row 2: [2, &quot;Bob&quot;, 35, &quot;2024-02-20&quot;]                               │  │
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a>│  │  ...                                                               │  │
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a>│  └───────────────────────────────────────────────────────────────────┘  │
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a>│                                                                          │
<a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a>│  ┌───────────────────────────────────────────────────────────────────┐  │
<a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a>│  │                        DATA BLOCK 2                                │  │
<a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a>│  │  (same structure)                                                  │  │
<a id="__codelineno-28-25" name="__codelineno-28-25" href="#__codelineno-28-25"></a>│  └───────────────────────────────────────────────────────────────────┘  │
<a id="__codelineno-28-26" name="__codelineno-28-26" href="#__codelineno-28-26"></a>└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>
<p><strong>Schema Definition:</strong></p>
<p>Avro schemas are defined in JSON:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="p">{</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;record&quot;</span><span class="p">,</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Customer&quot;</span><span class="p">,</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="w">  </span><span class="nt">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;com.example&quot;</span><span class="p">,</span>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="w">  </span><span class="nt">&quot;fields&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;customer_id&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;int&quot;</span><span class="p">},</span>
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;name&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">},</span>
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;age&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;null&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;int&quot;</span><span class="p">],</span><span class="w"> </span><span class="nt">&quot;default&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">},</span>
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;signup_date&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a><span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;int&quot;</span><span class="p">,</span>
<a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a><span class="w">      </span><span class="nt">&quot;logicalType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;date&quot;</span>
<a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a><span class="w">    </span><span class="p">}},</span>
<a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a><span class="w">    </span><span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tags&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">}}</span>
<a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a><span class="w">  </span><span class="p">]</span>
<a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Schema Evolution:</strong></p>
<p>Avro's killer feature is robust schema evolution. You can:
- Add fields (with defaults) without breaking readers
- Remove fields without breaking readers (if they have defaults)
- Rename fields using aliases</p>
<p>This makes Avro ideal for streaming systems where producers and consumers may be updated independently.</p>
<p><strong>Compression:</strong></p>
<p>"Avro uses a binary format which benefits data compaction. Binary data is highly compact compared to JSON or XML formats. Hence the speed of serialization and deserialization also increases" (Hevo Data, 2024).</p>
<p><strong>When to use Avro:</strong>
- Apache Kafka message serialization
- Real-time streaming pipelines
- Systems requiring schema evolution
- Write-heavy workloads
- Data interchange between services</p>
<p><strong>Python usage:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fastavro</span><span class="w"> </span><span class="kn">import</span> <span class="n">writer</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">parse_schema</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="c1"># Define schema</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="n">schema</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;record&quot;</span><span class="p">,</span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Customer&quot;</span><span class="p">,</span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>    <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;customer_id&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span><span class="p">},</span>
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">},</span>
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span><span class="p">}</span>
<a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>    <span class="p">]</span>
<a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="p">}</span>
<a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a><span class="n">parsed_schema</span> <span class="o">=</span> <span class="n">parse_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>
<a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="c1"># Write Avro</span>
<a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="n">records</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>    <span class="p">{</span><span class="s2">&quot;customer_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">28</span><span class="p">},</span>
<a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a>    <span class="p">{</span><span class="s2">&quot;customer_id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">}</span>
<a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a><span class="p">]</span>
<a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a>
<a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;customers.avro&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a>    <span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">parsed_schema</span><span class="p">,</span> <span class="n">records</span><span class="p">)</span>
<a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a>
<a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a><span class="c1"># Read Avro</span>
<a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;customers.avro&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a>    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
<a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</code></pre></div></p>
<hr />
<h3 id="233-format-comparison">2.3.3 Format Comparison<a class="headerlink" href="#233-format-comparison" title="Permanent link">&para;</a></h3>
<p><strong>Storage Efficiency:</strong></p>
<p>Testing with identical data reveals dramatic differences:</p>
<p>"Both CSV and JSON are losing a lot compared to Avro and Parquet, however, this is expected because both Avro and Parquet are binary formats (they also use compression) while CSV and JSON are not compressed" (DataCrump, 2023).</p>
<table>
<thead>
<tr>
<th>Format</th>
<th>Relative Size</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>JSON</td>
<td>140%</td>
<td>Keys repeated, no compression</td>
</tr>
<tr>
<td>CSV</td>
<td>100%</td>
<td>Baseline (uncompressed)</td>
</tr>
<tr>
<td>CSV (gzip)</td>
<td>15-25%</td>
<td>Compressed text</td>
</tr>
<tr>
<td>Avro</td>
<td>25-40%</td>
<td>Binary, row-based</td>
</tr>
<tr>
<td>Parquet</td>
<td>10-20%</td>
<td>Binary, columnar, excellent compression</td>
</tr>
</tbody>
</table>
<p><strong>Query Performance:</strong></p>
<p>For analytical queries selecting specific columns:</p>
<table>
<thead>
<tr>
<th>Format</th>
<th>Relative Query Time</th>
</tr>
</thead>
<tbody>
<tr>
<td>CSV</td>
<td>100% (baseline)</td>
</tr>
<tr>
<td>JSON</td>
<td>120-150%</td>
</tr>
<tr>
<td>Avro</td>
<td>50-70%</td>
</tr>
<tr>
<td>Parquet</td>
<td>5-15%</td>
</tr>
</tbody>
</table>
<p>The dramatic improvement with Parquet comes from column pruning and predicate pushdown.</p>
<p><strong>Decision Framework:</strong></p>
<p>"CSV and JSON are suitable for small datasets (&lt;1,000,000 rows) or quick implementations, while Parquet, Avro, or ORC are better for large datasets with specific data behaviors" (Medium, 2024).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>                    ┌─────────────────────────────────────────┐
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>                    │         FORMAT SELECTION GUIDE          │
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>                    └─────────────────────────────────────────┘
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>                                       │
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>                                       ▼
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>                    ┌─────────────────────────────────────────┐
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>                    │        Is the data &gt; 100MB?             │
<a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>                    └─────────────────────────────────────────┘
<a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>                                       │
<a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a>                      ┌────────────────┴────────────────┐
<a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a>                      │ NO                              │ YES
<a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a>                      ▼                                 ▼
<a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a>        ┌──────────────────────┐          ┌──────────────────────┐
<a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a>        │ Need human editing?  │          │ Streaming/real-time? │
<a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a>        └──────────────────────┘          └──────────────────────┘
<a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a>                      │                              │
<a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a>           ┌──────────┴──────────┐        ┌─────────┴─────────┐
<a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a>           │ YES            NO   │        │ YES           NO  │
<a id="__codelineno-31-19" name="__codelineno-31-19" href="#__codelineno-31-19"></a>           ▼                ▼    │        ▼               ▼   │
<a id="__codelineno-31-20" name="__codelineno-31-20" href="#__codelineno-31-20"></a>        ┌──────┐        ┌──────┐│     ┌──────┐       ┌──────┐│
<a id="__codelineno-31-21" name="__codelineno-31-21" href="#__codelineno-31-21"></a>        │ CSV  │        │ JSON ││     │ AVRO │       │PARQUET│
<a id="__codelineno-31-22" name="__codelineno-31-22" href="#__codelineno-31-22"></a>        │      │        │      ││     │      │       │      ││
<a id="__codelineno-31-23" name="__codelineno-31-23" href="#__codelineno-31-23"></a>        └──────┘        └──────┘│     └──────┘       └──────┘│
<a id="__codelineno-31-24" name="__codelineno-31-24" href="#__codelineno-31-24"></a>                                │                            │
<a id="__codelineno-31-25" name="__codelineno-31-25" href="#__codelineno-31-25"></a>                                └────────────────────────────┘
</code></pre></div>
<hr />
<h2 id="24-data-types-precision-and-efficiency">2.4 Data Types: Precision and Efficiency<a class="headerlink" href="#24-data-types-precision-and-efficiency" title="Permanent link">&para;</a></h2>
<p>Within any format, data is represented using specific types. Understanding types improves both correctness and performance.</p>
<h3 id="241-numeric-types">2.4.1 Numeric Types<a class="headerlink" href="#241-numeric-types" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Type</th>
<th>Size</th>
<th>Range</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>int8</code> / <code>tinyint</code></td>
<td>1 byte</td>
<td>-128 to 127</td>
<td>Age, small counts</td>
</tr>
<tr>
<td><code>int16</code> / <code>smallint</code></td>
<td>2 bytes</td>
<td>-32,768 to 32,767</td>
<td>Year, medium counts</td>
</tr>
<tr>
<td><code>int32</code> / <code>int</code></td>
<td>4 bytes</td>
<td>±2.1 billion</td>
<td>Most integers</td>
</tr>
<tr>
<td><code>int64</code> / <code>bigint</code></td>
<td>8 bytes</td>
<td>±9.2 quintillion</td>
<td>Large IDs, timestamps</td>
</tr>
<tr>
<td><code>float32</code> / <code>float</code></td>
<td>4 bytes</td>
<td>~7 decimal digits</td>
<td>Approximate values</td>
</tr>
<tr>
<td><code>float64</code> / <code>double</code></td>
<td>8 bytes</td>
<td>~15 decimal digits</td>
<td>Scientific, financial</td>
</tr>
<tr>
<td><code>decimal</code></td>
<td>Variable</td>
<td>Exact precision</td>
<td>Currency, percentages</td>
</tr>
</tbody>
</table>
<p><strong>Choosing the right numeric type:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="c1"># Memory comparison</span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="n">n</span> <span class="o">=</span> <span class="mi">1_000_000</span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="c1"># Using default int64 (8 bytes × 1M = 8MB)</span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="n">ages_int64</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;int64: </span><span class="si">{</span><span class="n">ages_int64</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>  <span class="c1"># 8.0 MB</span>
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="c1"># Using int8 (1 byte × 1M = 1MB) - ages fit in 0-127</span>
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="n">ages_int8</span> <span class="o">=</span> <span class="n">ages_int64</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int8&#39;</span><span class="p">)</span>
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;int8: </span><span class="si">{</span><span class="n">ages_int8</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>    <span class="c1"># 1.0 MB</span>
<a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>
<a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a><span class="c1"># 8x memory savings!</span>
</code></pre></div>
<h3 id="242-string-types">2.4.2 String Types<a class="headerlink" href="#242-string-types" title="Permanent link">&para;</a></h3>
<p>Strings are often the largest memory consumers in datasets:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="c1"># String optimization with categories</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>    <span class="s1">&#39;country&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;USA&#39;</span><span class="p">,</span> <span class="s1">&#39;UK&#39;</span><span class="p">,</span> <span class="s1">&#39;Germany&#39;</span><span class="p">,</span> <span class="s1">&#39;France&#39;</span><span class="p">],</span> <span class="mi">1_000_000</span><span class="p">)</span>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="p">})</span>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="c1"># Default object dtype</span>
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Object: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>  <span class="c1"># ~64 MB</span>
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="c1"># Category dtype (for low-cardinality strings)</span>
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a><span class="n">df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Category: </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>  <span class="c1"># ~1 MB</span>
</code></pre></div>
<h3 id="243-date-and-time-types">2.4.3 Date and Time Types<a class="headerlink" href="#243-date-and-time-types" title="Permanent link">&para;</a></h3>
<p>Temporal data requires careful handling:</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Storage</th>
<th>Precision</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>date</code></td>
<td>4 bytes</td>
<td>Day</td>
<td>2025-11-29</td>
</tr>
<tr>
<td><code>datetime64[ns]</code></td>
<td>8 bytes</td>
<td>Nanosecond</td>
<td>2025-11-29 14:30:15.123456789</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td>8 bytes</td>
<td>Varies</td>
<td>Unix epoch milliseconds</td>
</tr>
<tr>
<td><code>time</code></td>
<td>Variable</td>
<td>Sub-second</td>
<td>14:30:15.123</td>
</tr>
<tr>
<td><code>interval</code></td>
<td>Variable</td>
<td>Duration</td>
<td>3 days, 4 hours</td>
</tr>
</tbody>
</table>
<p><strong>Best practices:</strong>
- Store timestamps in UTC
- Use ISO 8601 format for string representation
- Be explicit about timezone handling
- Choose appropriate precision (do you need nanoseconds?)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="c1"># Parse dates explicitly</span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data.csv&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">,</span> <span class="s1">&#39;updated_at&#39;</span><span class="p">])</span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="c1"># Handle timezones</span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="n">df</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">],</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="n">df</span><span class="p">[</span><span class="s1">&#39;created_at_local&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;created_at&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="s1">&#39;America/New_York&#39;</span><span class="p">)</span>
</code></pre></div>
<h3 id="244-boolean-and-null-types">2.4.4 Boolean and Null Types<a class="headerlink" href="#244-boolean-and-null-types" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Boolean</strong>: <code>true</code>/<code>false</code> - ideally 1 bit, often stored as 1 byte</li>
<li><strong>Null/None</strong>: Represents missing data - handling varies by system</li>
</ul>
<p><strong>Null handling strategies:</strong></p>
<table>
<thead>
<tr>
<th>Strategy</th>
<th>When to Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Keep as null</td>
<td>Value is genuinely unknown</td>
</tr>
<tr>
<td>Default value</td>
<td>Reasonable default exists (0 for counts)</td>
</tr>
<tr>
<td>Sentinel value</td>
<td>-1, "UNKNOWN", empty string</td>
</tr>
<tr>
<td>Imputation</td>
<td>Statistical estimate appropriate</td>
</tr>
<tr>
<td>Exclusion</td>
<td>Analysis can proceed without the record</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="25-working-with-nested-data">2.5 Working with Nested Data<a class="headerlink" href="#25-working-with-nested-data" title="Permanent link">&para;</a></h2>
<p>Semi-structured data with nested objects and arrays requires special handling to prepare for analysis.</p>
<h3 id="251-the-nested-data-challenge">2.5.1 The Nested Data Challenge<a class="headerlink" href="#251-the-nested-data-challenge" title="Permanent link">&para;</a></h3>
<p>Consider this common e-commerce data structure:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="p">{</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="w">  </span><span class="nt">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ord_12345&quot;</span><span class="p">,</span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w">  </span><span class="nt">&quot;customer&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cust_789&quot;</span><span class="p">,</span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Alice Smith&quot;</span><span class="p">,</span>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="w">    </span><span class="nt">&quot;address&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="w">      </span><span class="nt">&quot;street&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123 Main St&quot;</span><span class="p">,</span>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="w">      </span><span class="nt">&quot;city&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;San Francisco&quot;</span><span class="p">,</span>
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="w">      </span><span class="nt">&quot;state&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CA&quot;</span><span class="p">,</span>
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a><span class="w">      </span><span class="nt">&quot;zip&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;94102&quot;</span>
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a><span class="w">  </span><span class="nt">&quot;items&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a><span class="w">      </span><span class="nt">&quot;product_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;prod_001&quot;</span><span class="p">,</span>
<a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a><span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Wireless Headphones&quot;</span><span class="p">,</span>
<a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a><span class="w">      </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">249.99</span><span class="p">,</span>
<a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a><span class="w">      </span><span class="nt">&quot;quantity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a><span class="w">      </span><span class="nt">&quot;product_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;prod_002&quot;</span><span class="p">,</span>
<a id="__codelineno-35-22" name="__codelineno-35-22" href="#__codelineno-35-22"></a><span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Phone Case&quot;</span><span class="p">,</span>
<a id="__codelineno-35-23" name="__codelineno-35-23" href="#__codelineno-35-23"></a><span class="w">      </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">29.99</span><span class="p">,</span>
<a id="__codelineno-35-24" name="__codelineno-35-24" href="#__codelineno-35-24"></a><span class="w">      </span><span class="nt">&quot;quantity&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>
<a id="__codelineno-35-25" name="__codelineno-35-25" href="#__codelineno-35-25"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-35-26" name="__codelineno-35-26" href="#__codelineno-35-26"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-35-27" name="__codelineno-35-27" href="#__codelineno-35-27"></a><span class="w">  </span><span class="nt">&quot;totals&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-35-28" name="__codelineno-35-28" href="#__codelineno-35-28"></a><span class="w">    </span><span class="nt">&quot;subtotal&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">309.97</span><span class="p">,</span>
<a id="__codelineno-35-29" name="__codelineno-35-29" href="#__codelineno-35-29"></a><span class="w">    </span><span class="nt">&quot;tax&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">27.90</span><span class="p">,</span>
<a id="__codelineno-35-30" name="__codelineno-35-30" href="#__codelineno-35-30"></a><span class="w">    </span><span class="nt">&quot;shipping&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-35-31" name="__codelineno-35-31" href="#__codelineno-35-31"></a><span class="w">    </span><span class="nt">&quot;total&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">337.87</span>
<a id="__codelineno-35-32" name="__codelineno-35-32" href="#__codelineno-35-32"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-35-33" name="__codelineno-35-33" href="#__codelineno-35-33"></a><span class="p">}</span>
</code></pre></div>
<p>This cannot be directly loaded into a flat table. We need <strong>flattening</strong> strategies.</p>
<h3 id="252-flattening-strategies">2.5.2 Flattening Strategies<a class="headerlink" href="#252-flattening-strategies" title="Permanent link">&para;</a></h3>
<p><strong>Strategy 1: Dot notation flattening (nested objects)</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">json_normalize</span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>  <span class="c1"># The JSON above</span>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="c1"># Flatten nested objects</span>
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="n">df</span> <span class="o">=</span> <span class="n">json_normalize</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="c1"># Result:</span>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="c1"># order_id | customer.id | customer.name | customer.address.street | ... | items | totals.total</span>
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="c1"># ord_12345| cust_789    | Alice Smith   | 123 Main St             | ... | [...]  | 337.87</span>
</code></pre></div>
<p><strong>Strategy 2: Exploding arrays</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="c1"># Explode the items array</span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="n">df</span> <span class="o">=</span> <span class="n">json_normalize</span><span class="p">(</span>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>    <span class="n">data</span><span class="p">,</span>
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>    <span class="n">record_path</span><span class="o">=</span><span class="s1">&#39;items&#39;</span><span class="p">,</span>                    <span class="c1"># Array to explode</span>
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>    <span class="n">meta</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;order_id&#39;</span><span class="p">,</span>                       <span class="c1"># Fields to keep from parent</span>
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>          <span class="p">[</span><span class="s1">&#39;customer&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">],</span>
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>          <span class="p">[</span><span class="s1">&#39;customer&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">],</span>
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a>          <span class="p">[</span><span class="s1">&#39;totals&#39;</span><span class="p">,</span> <span class="s1">&#39;total&#39;</span><span class="p">]],</span>
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>    <span class="n">meta_prefix</span><span class="o">=</span><span class="s1">&#39;order_&#39;</span>                    <span class="c1"># Prefix for parent fields</span>
<a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a><span class="p">)</span>
<a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a>
<a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a><span class="c1"># Result:</span>
<a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a><span class="c1"># product_id | name               | price  | quantity | order_order_id | order_customer.id | order_totals.total</span>
<a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a><span class="c1"># prod_001   | Wireless Headphones| 249.99 | 1        | ord_12345      | cust_789          | 337.87</span>
<a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a><span class="c1"># prod_002   | Phone Case         | 29.99  | 2        | ord_12345      | cust_789          | 337.87</span>
</code></pre></div>
<p><strong>Strategy 3: PySpark approach</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">functions</span> <span class="k">as</span> <span class="n">F</span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="c1"># Read nested JSON</span>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="s2">&quot;orders.json&quot;</span><span class="p">)</span>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="c1"># Access nested fields with dot notation</span>
<a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a>    <span class="s2">&quot;order_id&quot;</span><span class="p">,</span>
<a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a>    <span class="s2">&quot;customer.id&quot;</span><span class="p">,</span>
<a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a>    <span class="s2">&quot;customer.name&quot;</span><span class="p">,</span>
<a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a>    <span class="s2">&quot;customer.address.city&quot;</span>
<a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a><span class="p">)</span>
<a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a>
<a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a><span class="c1"># Explode arrays</span>
<a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a><span class="n">df_items</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a>    <span class="s2">&quot;order_id&quot;</span><span class="p">,</span>
<a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a>    <span class="s2">&quot;customer.id&quot;</span><span class="p">,</span>
<a id="__codelineno-38-18" name="__codelineno-38-18" href="#__codelineno-38-18"></a>    <span class="n">F</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s2">&quot;items&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;item&quot;</span><span class="p">)</span>
<a id="__codelineno-38-19" name="__codelineno-38-19" href="#__codelineno-38-19"></a><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span>
<a id="__codelineno-38-20" name="__codelineno-38-20" href="#__codelineno-38-20"></a>    <span class="s2">&quot;order_id&quot;</span><span class="p">,</span>
<a id="__codelineno-38-21" name="__codelineno-38-21" href="#__codelineno-38-21"></a>    <span class="s2">&quot;id&quot;</span><span class="p">,</span>
<a id="__codelineno-38-22" name="__codelineno-38-22" href="#__codelineno-38-22"></a>    <span class="s2">&quot;item.product_id&quot;</span><span class="p">,</span>
<a id="__codelineno-38-23" name="__codelineno-38-23" href="#__codelineno-38-23"></a>    <span class="s2">&quot;item.name&quot;</span><span class="p">,</span>
<a id="__codelineno-38-24" name="__codelineno-38-24" href="#__codelineno-38-24"></a>    <span class="s2">&quot;item.price&quot;</span><span class="p">,</span>
<a id="__codelineno-38-25" name="__codelineno-38-25" href="#__codelineno-38-25"></a>    <span class="s2">&quot;item.quantity&quot;</span>
<a id="__codelineno-38-26" name="__codelineno-38-26" href="#__codelineno-38-26"></a><span class="p">)</span>
</code></pre></div>
<h3 id="253-when-to-flatten-vs-keep-nested">2.5.3 When to Flatten vs. Keep Nested<a class="headerlink" href="#253-when-to-flatten-vs-keep-nested" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Keep Nested</th>
<th>Flatten</th>
</tr>
</thead>
<tbody>
<tr>
<td>Document databases (MongoDB)</td>
<td>Analytical queries</td>
</tr>
<tr>
<td>API responses</td>
<td>Machine learning features</td>
</tr>
<tr>
<td>Event archives</td>
<td>Reporting and BI</td>
</tr>
<tr>
<td>Schema flexibility needed</td>
<td>SQL-based analysis</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="26-summary-and-key-concepts">2.6 Summary and Key Concepts<a class="headerlink" href="#26-summary-and-key-concepts" title="Permanent link">&para;</a></h2>
<p>This chapter provided comprehensive coverage of data types and file formats:</p>
<h3 id="data-structure-spectrum">Data Structure Spectrum<a class="headerlink" href="#data-structure-spectrum" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Structured</strong>: Fixed schema, tables, SQL-queryable</li>
<li><strong>Semi-structured</strong>: Flexible, nested, self-describing (JSON, XML)</li>
<li><strong>Unstructured</strong>: No schema, requires ML/NLP to process</li>
</ul>
<h3 id="file-format-selection">File Format Selection<a class="headerlink" href="#file-format-selection" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>CSV</strong>: Universal but limited—use for small data and interchange</li>
<li><strong>JSON</strong>: Flexible, nested support—use for APIs and configuration</li>
<li><strong>Parquet</strong>: Columnar, compressed—use for analytics and data lakes</li>
<li><strong>Avro</strong>: Row-based, schema evolution—use for streaming and Kafka</li>
</ul>
<h3 id="key-insight">Key Insight<a class="headerlink" href="#key-insight" title="Permanent link">&para;</a></h3>
<p>"JSON has the largest footprint because it stores the schema attributes for each row. For this reason, I rarely store JSON or CSV formats in curated and transformed zone in a data lake" (Towards Data Science, 2023).</p>
<hr />
<h2 id="27-further-reading-and-resources">2.7 Further Reading and Resources<a class="headerlink" href="#27-further-reading-and-resources" title="Permanent link">&para;</a></h2>
<h3 id="papers-and-articles">Papers and Articles<a class="headerlink" href="#papers-and-articles" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Mbata, A. et al. (2024). "A Survey of Pipeline Tools for Data Engineering."</strong> arXiv:2406.08335. Comprehensive survey of data engineering tools and formats. https://arxiv.org/abs/2406.08335</li>
<li><strong>Wickham, H. (2014). "Tidy Data."</strong> Journal of Statistical Software. Foundational paper on data organization principles. https://vita.had.co.nz/papers/tidy-data.pdf</li>
</ul>
<h3 id="technical-documentation">Technical Documentation<a class="headerlink" href="#technical-documentation" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Apache Parquet Documentation</strong>: https://parquet.apache.org/docs/</li>
<li><strong>Apache Avro Specification</strong>: https://avro.apache.org/docs/current/spec.html</li>
<li><strong>JSON Specification (RFC 8259)</strong>: https://datatracker.ietf.org/doc/html/rfc8259</li>
</ul>
<h3 id="practical-comparisons">Practical Comparisons<a class="headerlink" href="#practical-comparisons" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>DataCrump: CSV vs Parquet vs JSON vs Avro</strong>: Hands-on performance comparison with benchmarks. https://datacrump.com/csv-parquet-json-avro/</li>
</ul>
<h3 id="books_1">Books<a class="headerlink" href="#books_1" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Reis, J. &amp; Housley, M. (2022). <em>Fundamentals of Data Engineering</em>.</strong> O'Reilly Media. Chapter 5 covers data formats in depth.</li>
<li><strong>Kleppmann, M. (2017). <em>Designing Data-Intensive Applications</em>.</strong> O'Reilly Media. Chapter 4 discusses encoding and evolution.</li>
</ul>
<hr />
<h2 id="28-exercises">2.8 Exercises<a class="headerlink" href="#28-exercises" title="Permanent link">&para;</a></h2>
<p><strong>Exercise 2.1: Format Conversion and Comparison</strong></p>
<p>Take a CSV file of at least 100,000 rows and:
1. Convert it to JSON, Parquet, and Avro formats
2. Compare file sizes for each format
3. Measure read times for loading into pandas
4. Apply compression (gzip for CSV/JSON, snappy for Parquet) and compare again</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="c1"># Your code here</span>
<a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;your_data.csv&#39;</span><span class="p">)</span>
<a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a>
<a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="c1"># Save in different formats and measure</span>
<a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a><span class="n">formats</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a>    <span class="s1">&#39;csv&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;output.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
<a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a>    <span class="s1">&#39;json&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">&#39;output.json&#39;</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">),</span>
<a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a>    <span class="s1">&#39;parquet&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s1">&#39;output.parquet&#39;</span><span class="p">),</span>
<a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a><span class="p">}</span>
<a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a>
<a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">save_func</span> <span class="ow">in</span> <span class="n">formats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a>    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a>    <span class="n">save_func</span><span class="p">()</span>
<a id="__codelineno-39-18" name="__codelineno-39-18" href="#__codelineno-39-18"></a>    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
<a id="__codelineno-39-19" name="__codelineno-39-19" href="#__codelineno-39-19"></a>    <span class="n">size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output.</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e6</span>
<a id="__codelineno-39-20" name="__codelineno-39-20" href="#__codelineno-39-20"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MB, </span><span class="si">{</span><span class="n">elapsed</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Exercise 2.2: Nested Data Transformation</strong></p>
<p>Given this nested JSON structure, create a flat DataFrame suitable for analysis:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="p">{</span>
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="w">  </span><span class="nt">&quot;users&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span>
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="w">      </span><span class="nt">&quot;profile&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="w">        </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span>
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="w">        </span><span class="nt">&quot;occupation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Engineer&quot;</span>
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a><span class="w">      </span><span class="p">},</span>
<a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a><span class="w">      </span><span class="nt">&quot;sessions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a><span class="w">        </span><span class="p">{</span><span class="nt">&quot;date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-01&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;duration_minutes&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">45</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;pages_viewed&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">},</span>
<a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a><span class="w">        </span><span class="p">{</span><span class="nt">&quot;date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-02&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;duration_minutes&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;pages_viewed&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">}</span>
<a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a><span class="w">      </span><span class="p">]</span>
<a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a><span class="w">    </span><span class="p">},</span>
<a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a><span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a><span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span>
<a id="__codelineno-40-18" name="__codelineno-40-18" href="#__codelineno-40-18"></a><span class="w">      </span><span class="nt">&quot;profile&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-40-19" name="__codelineno-40-19" href="#__codelineno-40-19"></a><span class="w">        </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">35</span><span class="p">,</span>
<a id="__codelineno-40-20" name="__codelineno-40-20" href="#__codelineno-40-20"></a><span class="w">        </span><span class="nt">&quot;occupation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Designer&quot;</span>
<a id="__codelineno-40-21" name="__codelineno-40-21" href="#__codelineno-40-21"></a><span class="w">      </span><span class="p">},</span>
<a id="__codelineno-40-22" name="__codelineno-40-22" href="#__codelineno-40-22"></a><span class="w">      </span><span class="nt">&quot;sessions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-40-23" name="__codelineno-40-23" href="#__codelineno-40-23"></a><span class="w">        </span><span class="p">{</span><span class="nt">&quot;date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-01&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;duration_minutes&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;pages_viewed&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">}</span>
<a id="__codelineno-40-24" name="__codelineno-40-24" href="#__codelineno-40-24"></a><span class="w">      </span><span class="p">]</span>
<a id="__codelineno-40-25" name="__codelineno-40-25" href="#__codelineno-40-25"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-40-26" name="__codelineno-40-26" href="#__codelineno-40-26"></a><span class="w">  </span><span class="p">]</span>
<a id="__codelineno-40-27" name="__codelineno-40-27" href="#__codelineno-40-27"></a><span class="p">}</span>
</code></pre></div>
<p>Create two DataFrames:
1. User-level DataFrame with profile information
2. Session-level DataFrame with user context</p>
<p><strong>Exercise 2.3: Schema Design</strong></p>
<p>Design a data schema for a ride-sharing application (like Uber/Lyft). Consider:
- What events should be tracked?
- What fields should each event have?
- What data types are appropriate for each field?
- How should nested data (e.g., route waypoints) be structured?</p>
<p>Document your schema in JSON Schema format.</p>
<p><strong>Exercise 2.4: Type Optimization</strong></p>
<p>Given a DataFrame with default types, optimize memory usage by selecting appropriate types:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="c1"># Create sample data with suboptimal types</span>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a>    <span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">),</span>        <span class="c1"># Could be int32</span>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a>    <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">),</span>                <span class="c1"># Could be int8</span>
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a>    <span class="s1">&#39;country&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;US&#39;</span><span class="p">,</span> <span class="s1">&#39;UK&#39;</span><span class="p">,</span> <span class="s1">&#39;DE&#39;</span><span class="p">,</span> <span class="s1">&#39;FR&#39;</span><span class="p">],</span> <span class="mi">1000000</span><span class="p">),</span>  <span class="c1"># Could be category</span>
<a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a>    <span class="s1">&#39;is_premium&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="mi">1000000</span><span class="p">),</span>   <span class="c1"># Already boolean</span>
<a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a>    <span class="s1">&#39;balance&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">),</span>          <span class="c1"># Could be float32</span>
<a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a><span class="p">})</span>
<a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a>
<a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original memory: </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
<a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a>
<a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a><span class="c1"># Your optimization code here</span>
<a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a><span class="c1"># Target: Reduce memory by at least 50%</span>
</code></pre></div>
<hr />
<h1 id="end-of-part-i-foundations">End of Part I: Foundations<a class="headerlink" href="#end-of-part-i-foundations" title="Permanent link">&para;</a></h1>
<p>The next part of this course will cover <strong>Data Collection and Storage</strong>, including:
- Chapter 3: Data Sources and Collection Methods
- Chapter 4: Relational Databases and SQL
- Chapter 5: Data Warehouses, Data Lakes, and Modern Storage Architectures</p>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "navigation.tracking", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.min.js"></script>
      
    
  </body>
</html>